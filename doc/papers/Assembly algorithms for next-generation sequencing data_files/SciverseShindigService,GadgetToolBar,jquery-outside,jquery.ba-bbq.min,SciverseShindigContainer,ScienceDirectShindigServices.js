var HOOVER_HEIGHT_DEFAULT=200;var HOOVER_WIDTH_DEFAULT=300;var HOOVER_MINIMUM_HEIGHT=120;var HOOVER_MINIMUM_WIDTH=180;var HOOVER_MAX_HEIGHT=600;var HOOVER_MAX_WIDTH=800;
/*! jQuery Migrate v1.2.1 | (c) 2005, 2013 jQuery Foundation, Inc. and other contributors | jquery.org/license */
jQuery.migrateMute===void 0&&(jQuery.migrateMute=!0),function(ah,O,Y){function U(b){var a=O.console;ad[b]||(ad[b]=!0,ah.migrateWarnings.push(b),a&&a.warn&&!ah.migrateMute&&(a.warn("JQMIGRATE: "+b),ah.migrateTrace&&a.trace&&a.trace()))}function al(d,b,c,f){if(Object.defineProperty){try{return Object.defineProperty(d,b,{configurable:!0,enumerable:!0,get:function(){return U(f),c},set:function(a){U(f),c=a}}),Y}catch(e){}}ah._definePropertyBroken=!0,d[b]=c}var ad={};ah.migrateWarnings=[],!ah.migrateMute&&O.console&&O.console.log&&O.console.log("JQMIGRATE: Logging is active"),ah.migrateTrace===Y&&(ah.migrateTrace=!0),ah.migrateReset=function(){ad={},ah.migrateWarnings.length=0},"BackCompat"===document.compatMode&&U("jQuery is not compatible with Quirks Mode");var X=ah("<input/>",{size:1}).attr("size")&&ah.attrFn,P=ah.attr,L=ah.attrHooks.value&&ah.attrHooks.value.get||function(){return null},aj=ah.attrHooks.value&&ah.attrHooks.value.set||function(){return Y},aa=/^(?:input|button)$/i,ai=/^[238]$/,W=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ag=/^(?:checked|selected)$/i;al(ah,"attrFn",X||{},"jQuery.attrFn is deprecated"),ah.attr=function(f,b,e,d){var j=b.toLowerCase(),h=f&&f.nodeType;return d&&(4>P.length&&U("jQuery.fn.attr( props, pass ) is deprecated"),f&&!ai.test(h)&&(X?b in X:ah.isFunction(ah.fn[b])))?ah(f)[b](e):("type"===b&&e!==Y&&aa.test(f.nodeName)&&f.parentNode&&U("Can't change the 'type' of an input or button in IE 6/7/8"),!ah.attrHooks[j]&&W.test(j)&&(ah.attrHooks[j]={get:function(l,m){var c,g=ah.prop(l,m);return g===!0||"boolean"!=typeof g&&(c=l.getAttributeNode(m))&&c.nodeValue!==!1?m.toLowerCase():Y},set:function(g,l,i){var c;return l===!1?ah.removeAttr(g,i):(c=ah.propFix[i]||i,c in g&&(g[c]=!0),g.setAttribute(i,i.toLowerCase())),i}},ag.test(j)&&U("jQuery.fn.attr('"+j+"') may use property instead of attribute")),P.call(ah,f,b,e))},ah.attrHooks.value={get:function(b,a){var c=(b.nodeName||"").toLowerCase();return"button"===c?L.apply(this,arguments):("input"!==c&&"option"!==c&&U("jQuery.fn.attr('value') no longer gets properties"),a in b?b.value:null)},set:function(d,c){var b=(d.nodeName||"").toLowerCase();return"button"===b?aj.apply(this,arguments):("input"!==b&&"option"!==b&&U("jQuery.fn.attr('value', val) no longer sets properties"),d.value=c,Y)}};var af,ae,K=ah.fn.init,Z=ah.parseJSON,F=/^([^<]*)(<[\w\W]+>)([^>]*)$/;ah.fn.init=function(d,e,b){var c;return d&&"string"==typeof d&&!ah.isPlainObject(e)&&(c=F.exec(ah.trim(d)))&&c[0]&&("<"!==d.charAt(0)&&U("$(html) HTML strings must start with '<' character"),c[3]&&U("$(html) HTML text after last tag is ignored"),"#"===c[0].charAt(0)&&(U("HTML string cannot start with a '#' character"),ah.error("JQMIGRATE: Invalid selector string (XSS)")),e&&e.context&&(e=e.context),ah.parseHTML)?K.call(this,ah.parseHTML(c[2],e,!0),e,b):K.apply(this,arguments)},ah.fn.init.prototype=ah.fn,ah.parseJSON=function(a){return a||null===a?Z.apply(this,arguments):(U("jQuery.parseJSON requires a valid JSON string"),null)},ah.uaMatch=function(b){b=b.toLowerCase();var a=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||0>b.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return{browser:a[1]||"",version:a[2]||"0"}},ah.browser||(af=ah.uaMatch(navigator.userAgent),ae={},af.browser&&(ae[af.browser]=!0,ae.version=af.version),ae.chrome?ae.webkit=!0:ae.webkit&&(ae.safari=!0),ah.browser=ae),al(ah,"browser",ah.browser,"jQuery.browser is deprecated"),ah.sub=function(){function a(c,d){return new a.fn.init(c,d)}ah.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,c){return c&&c instanceof ah&&!(c instanceof a)&&(c=a(c)),ah.fn.init.call(this,d,c,b)},a.fn.init.prototype=a.fn;var b=a(document);return U("jQuery.sub() is deprecated"),a},ah.ajaxSetup({converters:{"text json":ah.parseJSON}});var ak=ah.fn.data;ah.fn.data=function(d){var b,c,e=this[0];return !e||"events"!==d||1!==arguments.length||(b=ah.data(e,d),c=ah._data(e,d),b!==Y&&b!==c||c===Y)?ak.apply(this,arguments):(U("Use of jQuery.fn.data('events') is deprecated"),c)};var ac=/\/(java|ecma)script/i,J=ah.fn.andSelf||ah.fn.addBack;ah.fn.andSelf=function(){return U("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),J.apply(this,arguments)},ah.clean||(ah.clean=function(n,j,f,b){j=j||document,j=!j.nodeType&&j[0]||j,j=j.ownerDocument||j,U("jQuery.clean() is deprecated");var p,m,h,e,g=[];if(ah.merge(g,ah.buildFragment(n,j).childNodes),f){for(h=function(a){return !a.type||ac.test(a.type)?b?b.push(a.parentNode?a.parentNode.removeChild(a):a):f.appendChild(a):Y},p=0;null!=(m=g[p]);p++){ah.nodeName(m,"script")&&h(m)||(f.appendChild(m),m.getElementsByTagName!==Y&&(e=ah.grep(ah.merge([],m.getElementsByTagName("script")),h),g.splice.apply(g,[p+1,0].concat(e)),p+=e.length))}}return g});var B=ah.event.add,G=ah.event.remove,ab=ah.event.trigger,D=ah.fn.toggle,q=ah.fn.live,E=ah.fn.die,z="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",R=RegExp("\\b(?:"+z+")\\b"),I=/(?:^|\s)hover(\.\S+|)\b/,V=function(a){return"string"!=typeof a||ah.event.special.hover?a:(I.test(a)&&U("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),a&&a.replace(I,"mouseenter$1 mouseleave$1"))};ah.event.props&&"attrChange"!==ah.event.props[0]&&ah.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),ah.event.dispatch&&al(ah.event,"handle",ah.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),ah.event.add=function(f,d,g,b,c){f!==document&&R.test(d)&&U("AJAX events should be attached to document: "+d),B.call(this,f,V(d||""),g,b,c)},ah.event.remove=function(f,c,g,d,b){G.call(this,f,V(c)||"",g,d,b)},ah.fn.error=function(){var a=Array.prototype.slice.call(arguments,0);return U("jQuery.fn.error() is deprecated"),a.splice(0,0,"error"),arguments.length?this.bind.apply(this,a):(this.triggerHandler.apply(this,a),this)},ah.fn.toggle=function(d,g){if(!ah.isFunction(d)||!ah.isFunction(g)){return D.apply(this,arguments)}U("jQuery.fn.toggle(handler, handler...) is deprecated");var b=arguments,c=d.guid||ah.guid++,f=0,e=function(h){var a=(ah._data(this,"lastToggle"+d.guid)||0)%f;return ah._data(this,"lastToggle"+d.guid,a+1),h.preventDefault(),b[a].apply(this,arguments)||!1};for(e.guid=c;b.length>f;){b[f++].guid=c}return this.click(e)},ah.fn.live=function(c,d,b){return U("jQuery.fn.live() is deprecated"),q?q.apply(this,arguments):(ah(this.context).on(c,this.selector,d,b),this)},ah.fn.die=function(a,b){return U("jQuery.fn.die() is deprecated"),E?E.apply(this,arguments):(ah(this.context).off(a,this.selector||"**",b),this)},ah.event.trigger=function(d,c,f,b){return f||R.test(d)||U("Global events are undocumented and deprecated"),ab.call(this,d,c,f||document,b)},ah.each(z.split("|"),function(a,b){ah.event.special[b]={setup:function(){var c=this;return c!==document&&(ah.event.add(document,b+"."+ah.guid,function(){ah.event.trigger(b,null,c,!0)}),ah._data(this,b,ah.guid++)),!1},teardown:function(){return this!==document&&ah.event.remove(document,b+"."+ah._data(this,b)),!1}}})}(jQuery,window);shindig.SciverseService=function(){shindig.IfrGadgetService.call(this);gadgets.rpc.register("invokeResultsView",this.invokeResultsView);gadgets.rpc.register("invokeColumnView",this.invokeColumnView);gadgets.rpc.register("getContextInfo",this.getContextInfo);gadgets.rpc.register("getGadgetContext",this.getGadgetContext);gadgets.rpc.register("getBrowserProperty",this.getBrowserProperty);gadgets.rpc.register("getAllResults",this.getAllResults);gadgets.rpc.register("getResults",this.getResults);gadgets.rpc.register("getArticleContent",this.getArticleContent);gadgets.rpc.register("getPageUrl",this.getPageUrl);gadgets.rpc.register("showHoverView",this.showHoverView);gadgets.rpc.register("closeHover",this.closeHover);gadgets.rpc.register("closeAllMyHovers",this.closeAllHovers);gadgets.rpc.register("linkText",this.linkText);gadgets.rpc.register("linkTagText",this.linkTagText);gadgets.rpc.register("makeMeInvisible",this.makeMeInvisible);gadgets.rpc.register("makeMeVisible",this.makeMeVisible);gadgets.rpc.register("suggest",this.returnQuerySuggestions);gadgets.rpc.register("subscribe",this.subscribe);gadgets.rpc.register("getSubjectAreas",this.getSubjectAreas);gadgets.rpc.register("getContent",this.getContent);gadgets.rpc.register("getSubType",this.getSubType);gadgets.rpc.register("executeSDSearch",this.executeSDSearch);gadgets.rpc.register("executeScopusSearch",this.executeSCSearch);gadgets.rpc.register("executeHubSearch",this.executeHubSearch);gadgets.rpc.register("addButtons",this.addButtons);gadgets.rpc.register("removeButtons",this.removeButtons);gadgets.rpc.register("entitleGadget",this.entitleGadget);gadgets.rpc.register("closeCanvasView",this.closeCanvasView);gadgets.rpc.register("invokeWorkSpaceView",this.invokeWorkSpaceView);gadgets.rpc.register("getEuidCookie",this.getEuidCookie);gadgets.rpc.register("getSDRelatedArticles",this.getSDRelatedArticles);gadgets.rpc.register("isAuthorshipClaimedByUser",this.isAuthorshipClaimedByUser);gadgets.rpc.register("callAPPIndexService",this.callAPPIndexService)};shindig.SciverseService.inherits(shindig.IfrGadgetService);var sgf=sgf||{};shindig.SciverseService.prototype.getPageUrl=function(){return document.location.href};shindig.SciverseService.prototype.callAPPIndexService=function(b){var a=gadgets.json.stringify(b);var e=jQuery.parseJSON(a);var d="pii="+e.pii+"&gadgetId="+e.gadgetId;var c=new Array();c.push(sciverseObj.smapiVars.gsUrl);c.push("/rest/gadgetindex/gadget");jQuery.ajax({type:"GET",url:c.join(""),async:true,data:d});return true};shindig.SciverseService.prototype.getArticleContent=function(a,f){var d=this.f;if(true===a&&typeof SDM!=="undefined"&&typeof SDM.svapi!=="undefined"&&typeof SDM.svapi.getCurrentArticleContent==="function"){SDM.svapi.getCurrentArticleContent(sgf.relayArticleContentToGadget,d,f);return}else{if(typeof SDM!=="undefined"&&typeof SDM.svapi!=="undefined"&&typeof SDM.svapi.getArticleContent==="function"){SDM.svapi.getArticleContent(sgf.relayArticleContentToGadget,d,f);return}}var b=jQuery(".svBigBox");if(b.length>0){var e=b.clone();e.find(".containerApplOver, script, style, link").remove();sgf.relayArticleContentToGadget(this.f,f,e.html())}return};shindig.SciverseService.prototype.isAuthorshipClaimedByUser=function(b){var a=this.f;if(typeof SDM!=="undefined"&&typeof SDM.svapi!=="undefined"&&typeof SDM.svapi.isAuthorshipClaimedByUser==="function"){SDM.svapi.isAuthorshipClaimedByUser(sgf.relayArticleContentToGadget,a,b);return}return};shindig.SciverseService.prototype.getSDRelatedArticles=function(i,e){var g=this.f;var f="{error : erroroccured}";var c=sciverseObj.smapiVars.gsUrl;try{var h=c.indexOf("gadgetservices");var a=c.substring(0,h-1);var b=new Array();if(a!=null){b.push(a);b.push("/gadgetepfl/GetSDArticles?piiValue="+e)}jQuery.ajax({url:b.join(""),type:"GET",success:function(j){f=j;sgf.relayRelatedArticlesToGadget(g,i,f,a)},error:function(j){sgf.relayRelatedArticlesToGadget(g,i,f,a)}})}catch(d){sgf.relayRelatedArticlesToGadget(g,i,f,a)}};sgf.relayArticleContentToGadget=function(b,c,a){gadgets.rpc.call(b,c,null,a)};sgf.relayRelatedArticlesToGadget=function(c,d,b,a){gadgets.rpc.call(c,d,null,b,a)};sgf.currentCanvasHolder=null;shindig.SciverseService.prototype.closeCanvasView=function(){var b=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var a=shindig.container.getGadget(b);a.closeCanvas()};shindig.IfrGadgetService.prototype.requestNavigateTo=function(a,b){var d=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var c=shindig.container.getGadget(d);if(a=="canvas"){c.openCanvasView(b);return}};shindig.IfrGadgetService.prototype.setUserPref=function(h,b,d){var g=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var e=shindig.container.getGadget(g);for(var c=1,a=arguments.length;c<a;c+=2){if(typeof e.userPrefs[arguments[c]]!=="undefined"){e.userPrefs[arguments[c]].value=escape(encodeURIComponent(arguments[c+1]))}else{var f=new Object();f.name=arguments[c];f.value=escape(encodeURIComponent(arguments[c+1]));e.userPrefs[arguments[c]]=f}}e.saveUserPrefs()};shindig.SciverseService.prototype.invokeResultsView=function(b,a){if(sciverseObj.contextInfo.pageType=="library"){if(sciverseObj.contextInfo.currentView=="documents"){b="Doc_"+b}else{if(sciverseObj.contextInfo.currentView=="searches"){b="Srch_"+b}}}var e=jQuery("#resultsView_"+b);if(e.length==0){return false}var h=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var d=shindig.container.getGadget(h);e.show();var c="resultsView_"+b;if(jQuery("#resultsView"+b+"_"+d.sciverseId_).length!==0){return false}shindig.container.layoutManager=new shindig.FloatLeftLayoutManager(c);var g=shindig.container.createGadget({specUrl:d.specUrl,title:d.title,userPrefs:this.userPrefs,requiresPubSub2:this.requiresPubSub2});g.sciverseId_=d.sciverseId_;g.iconURL=d.iconURL;g.location="resultsView"+b;shindig.container.addGadget(g);var f=shindig.container.layoutManager.getGadgetChrome(g);g.prepareGadgetForView("sciverseResultsView",f,a)};shindig.SciverseService.prototype.invokeWorkSpaceView=function(a){if(jQuery("#workSpaceView").length==0){return false}var f=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var c=shindig.container.getGadget(f);var b="workSpaceView";var e=[];sgf.saveEventData(c.sciverseId_,sgfEvents.INVOKE_WORKSPACE_VIEW,b,e,"workspace");sgf.notifyEventSubscribers(sgfEvents.INVOKE_WORKSPACE_VIEW,e);if(jQuery("#workSpaceView_"+c.sciverseId_).length!==0){return false}shindig.container.layoutManager=new shindig.FloatLeftLayoutManager(b);var d=shindig.container.createGadget({specUrl:c.specUrl,title:c.title,userPrefs:c.userPrefs,requiresPubSub2:c.requiresPubSub2});d.sciverseId_=c.sciverseId_;d.iconURL=c.iconURL;d.location="workSpaceView";d.includeTitle=false;d.view="workspace";shindig.container.addGadget(d);d.prepareGadgetForView("workspace",null,a)};shindig.SciverseService.prototype.getContextInfo=function(){var a=gadgets.json.stringify(sciverseObj.contextInfo);a=convertFromHtmlEntities(a);var b=gadgets.json.parse(a);return b};shindig.SciverseService.prototype.getGadgetContext=function(){if(typeof SDM!=="undefined"&&typeof SDM.svapi!=="undefined"&&typeof SDM.svapi.getTransactionContext==="function"){return SDM.svapi.getTransactionContext()}return};shindig.SciverseService.prototype.getBrowserProperty=function(){var a={windowheight:jQuery(window).height(),windowwidth:jQuery(window).width(),headerwidth:jQuery("#header").width(),headerheight:jQuery("#header").height(),leftpaneheight:jQuery("#leftPane").height(),leftpanewidth:jQuery("#leftPane").width(),centerpanewidth:jQuery("#centerPane").width(),centerpaneheight:jQuery("#centerPane").height(),rightpaneheight:jQuery("#rightPane").height(),rightpanewidth:jQuery("#rightPane").width(),gadgetcontainerwidth:jQuery(".appContainer").width(),gadgetcontainerheight:jQuery(".appContainer").height(),workspacePanewidth:jQuery(".js_workspace_content").width(),workspacePaneHeight:jQuery(".js_workspace_content").height(),pageUrl:window.location.href};return a};shindig.SciverseService.prototype.getAllResults=function(){return resultList};shindig.SciverseService.prototype.getResults=function(a){var b=[];var d;for(var c=0;c<a.length;c++){d=a[c];b[c]=resultList[d]}return b};shindig.SciverseService.prototype.subscribe=function(c,g){if(typeof(listeners)=="undefined"||listeners==null){return}if(c==="query"){jQuery("#satab").show()}var f=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var e=shindig.container.getGadget(f);var a=(e.closed_)?"close":"open";var d=listeners[c];var b=new Object();b.frame=this.f;b.callback=g;if(!d){listeners[c]=new Array(b)}else{listeners[c].push(b)}return};shindig.SciverseService.prototype.returnQuerySuggestions=function(d,b){if(pin!=b||d.length==0){return}var a=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var c=shindig.container.getGadget(a);for(var f=0;f<d.length;f++){var e=new Object();e.icon=c.iconURL;e.text=d[f];e.gadgetId=c.sciverseId_;e.gadgetTitle=c.title;suggestions.push(e)}var j=jQuery("#suggestions").width();jQuery("#suggestions").width(j+2);jQuery("#suggestions").show();var g=jQuery("#suggestions ul");g.empty();for(var f=0;f<suggestions.length;f++){var l=jQuery("<li />").html('<img src="'+suggestions[f].icon+'" title="'+suggestions[f].gadgetTitle+'" class=appIcon style="position: relative;" />&nbsp;&nbsp; '+suggestions[f].text).addClass(f%2==0?"ac_even":"ac_odd").appendTo(g)[0];jQuery.data(l,"ac_data",suggestions[f].gadgetId+","+suggestions[f].text)}var m=jQuery("#suggestions").offset();var h=jQuery("#suggestions").attr("offsetHeight");jQuery("#satab").css({left:m.left,top:m.top+h,"z-index":300})};shindig.SciverseService.prototype.makeMeInvisible=function(){var c=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var b=shindig.container.getGadget(c);var a=(b.closed_)?"close":"open";if(b.requiresPubSub2){jQuery("#"+this.f).parent().parent().parent().addClass("invisible");jQuery("#"+this.f).css("visibility","hidden")}else{jQuery("#"+this.f).parent().parent().removeClass("sgfVisible");jQuery("#"+this.f).parent().parent().addClass("invisible")}a+="|invisible"};shindig.SciverseService.prototype.makeMeVisible=function(){var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var b=shindig.container.getGadget(e);var a=(b.closed_)?"close":"open";jQuery("#"+this.f).parent().parent().removeClass("invisible");if(jQuery("#"+this.f).parent().parent().parent().hasClass("sgfPrivilegedLocation")){jQuery("#"+this.f).parents(".sgfPrivilegedLocation").css("display","block")}if(b.requiresPubSub2){jQuery("#"+this.f).css("visibility","")}else{jQuery("#"+this.f).parent().parent().addClass("sgfVisible")}a+="|visible";if(a==="open|visible"){var d=[];var c="";if(b.view!=null){c=b.view}sgf.saveEventData(b.sciverseId_,sgfEvents.DISPLAY_GADGET,b.location,d,c);sgf.notifyEventSubscribers(sgfEvents.DISPLAY_GADGET,d)}};var gHooversMap={};shindig.SciverseService.prototype.showHoverView=function(h,b){if(typeof(gHooversMap[this.f])=="undefined"||gHooversMap[this.f]==null){gHooversMap[this.f]=0}else{gHooversMap[this.f]+=1}var u=gHooversMap[this.f];var a="hoover_"+this.f+"_"+u;jQuery("#"+a).remove();var z=document.createElement("div");z.id=a;z.style.position="absolute";var B=false;if(typeof(b)!="undefined"&&b!=""||b!=null){B=true}var l=false;if(B&&typeof(b.x)!="undefined"&&b.x!=""||b.x!=null){l=true}var n=false;if(B&&typeof(b.y)!="undefined"&&b.y!=""||b.y!=null){n=true}var v;if(B&&typeof(b.height)!="undefined"&&b.height!=""||b.height!=null){if(b.height<HOOVER_MINIMUM_HEIGHT){v=HOOVER_MINIMUM_HEIGHT}else{if(b.height>HOOVER_MAX_HEIGHT){v=HOOVER_MAX_HEIGHT}else{v=b.height}}}else{v=HOOVER_HEIGHT_DEFAULT}var t;if(B&&typeof(b.width)!="undefined"&&b.width!=""||b.width!=null){if(b.width<HOOVER_MINIMUM_WIDTH){t=HOOVER_MINIMUM_WIDTH}else{if(b.width>HOOVER_MAX_WIDTH){t=HOOVER_MAX_WIDTH}else{t=b.width}}}else{t=HOOVER_WIDTH_DEFAULT}var j=jQuery(window).scrollTop();var o=jQuery(window).scrollLeft();var r=jQuery(window).width();var e=jQuery(window).height();var q;var x;if(!l&&!n){q=r/2;q=q-(t/2);x=e/2;x=x+j-2*(v/3)}var s;var A;var g;var d;var y;var m;if(l&&n){s=b.x+8;A=b.y;g=(e+j)-(b.y+v);d=r-(b.x+t);y=b.x-t-o;m=b.y-v-j;if(g<0){A=b.y-(v)}if(m<0&&g<0){A=b.y}if(d<0){s=b.x-(t+46)}if(y<0&&d<0){s=b.x+20}}z.style.left=(B&&l&&s?s:q)+"px";z.style.top=(B&&n&&A?A:x)+"px";document.body.appendChild(z);shindig.container.layoutManager=new shindig.FloatLeftLayoutManager(a);var p=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var f=shindig.container.getGadget(p);if(!f.isHoverViewAvailable){alert("Hover view is not available in gadget xml.");return}var c=shindig.container.createGadget({height:v-25,specUrl:f.specUrl,title:f.title,userPrefs:f.userPrefs,requiresPubSub2:f.requiresPubSub2});c.sciverseId_=f.id;c.closed_=f.closed;c.iconURL=f.iconURL;c.location="hoover";c.locationOnPage="hoover";c.hasUserPrefs=f.hasUserPrefs;c.hooverIndex=u;c.pinPosition="absolute";shindig.container.addGadget(c);c.prepareGadgetForView("hover",z,h);var w=checkCompliance();var i=false;if(w=="Quirks"){i=true}jQuery("#"+a).css({width:t?(t):HOOVER_WIDTH_DEFAULT+"px",height:i?(v):"",padding:"0px",margin:"0px","z-index":"9999"});jQuery("#"+a).resizable({minHeight:HOOVER_MINIMUM_HEIGHT,minWidth:HOOVER_MINIMUM_WIDTH,start:function(D,F){var C=jQuery('<div style="background:#000;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);opacity:0;">&nbsp;</div>');jQuery("body").prepend(C[0]);C[0].id="temp_OverLayDiv";C.css({position:"absolute"});C.css({top:0,left:0});C.css("z-index","1009");C.height(2*(jQuery(document).height()));C.width("100%");var E=checkCompliance();if(E=="Quirks"&&truncateURL){jQuery("#"+c.getIframeId()).parent().css("position","absolute")}},resize:function(D,E){var C=(jQuery("#"+a).height()-jQuery("#hoover-"+c.id).height());jQuery("#"+c.getIframeId()).parent().css("height",C+"px");jQuery("#"+c.getIframeId()).css({height:C+"px",margin:"0px"})},stop:function(C,D){jQuery("#temp_OverLayDiv").remove();if(c.pinPosition=="fixed"){c.togglePin()}}});jQuery("#"+a).children(".ui-icon").css("background-image","url("+gadgetIconPath+"/ui-icons_222222_256x240.png)");jQuery("#"+a).draggable({handle:"#hoover-"+c.id,containment:"document",start:function(D,E){var C=jQuery("<div></div>");jQuery("body").prepend(C[0]);C[0].id="temp_OverLayDiv";C.css({position:"absolute"});C.css({top:0,left:0});C.css("z-index","1009");C.height(2*(jQuery(window).height()));C.width("100%")},stop:function(C,D){jQuery("#temp_OverLayDiv").remove()}});return u};shindig.SciverseService.prototype.closeHover=function(c){if(typeof(c)=="undefined"||c==null){return}var a=this.f;var b=jQuery("#hoover_"+a+"_"+c);if(b.length>0){b.remove()}};shindig.SciverseService.prototype.closeAllHovers=function(){var a=this.f;var b=jQuery("body>div").filter(function(c){return this.id.indexOf(a)>0});jQuery.each(b,function(c,d){jQuery("#"+d.id).remove()})};sgf.termListeners={};sgf.allCategories={author:"svAuthor",title:"svTitle",keywords:"svKeywords","abstract":"svAbstract",article:"svArticle",references:"svRefs",all:"svBigBox"};sgf.allNewCategories={author:"svAuthor",title:"svTitle",keywords:"svKeywords","abstract":"svAbstract",article:"svArticle",references:"svRefs"};sgf.linkTextFrames=new Array();shindig.SciverseService.prototype.linkText=function(d,b,f,a,e){var g=new Object();g.frame=this.f;g.terms=d;g.categories=b;g.frequency=f;g.occurence=a;g.callbackName=e;sgf.linkTextFrames.push(g);var c=null;sgf.doLinkText(c,this.f,d,b,f,a,e)};shindig.SciverseService.prototype.linkTagText=function(c,f,g,h,m,j,a,e,d,i){var b=new Object();b.frame=this.f;b.terms=c;b.categories=f;b.frequency=g;b.occurence=h;b.tags=m;b.sections=j;b.href=a;b.unLinkFlag=e;b.boundaryFlag=d;b.callbackName=i;sgf.linkTextFrames.push(b);var l=null;sgf.doTagLinkText(l,this.f,c,f,g,h,m,j,a,e,d,i)};sgf.doTagLinkText=function(a,d,g,q,m,n,l,o,u,i,s,h){var f="";var e={};var p=new Array();for(var j=0;j<g.length;j++){p.push(g[j])}if(p.length>0){if(m!="undefined"&&(m=="first"||m=="every")){if(m=="first"){n=1}if(n=="undefined"||n==""||n==null){n=1}if(jQuery.inArray("all",q)!=-1){if(a===null){jQuery.each(sgf.allNewCategories,function(t,y){if(l==null||l.length==0){a=jQuery("."+sgf.allCategories.all);sgf.iterateHTMLElements(a,p,d,m,n,e,h)}else{if(o==null||o.length==0){sgf.iterateTagHTMLElements(jQuery("."+y),p,d,m,n,e,h,y,l,1,u,i,s)}else{var x=jQuery("."+y);var c=0;sgf.doIterateTagLinkText(x,c,o,p,d,m,n,e,h,y,l,u,i,s)}}})}}else{if(a!==null){if(l==null||l.length==0){sgf.iterateHTMLElements(a,p,d,m,n,e,h)}else{sgf.iterateTagHTMLElements(a,p,d,m,n,e,h,r,l,1,u,i,s)}}else{for(var w=0;w<q.length;w++){if(l==null||l.length==0){sgf.iterateHTMLElements(jQuery("."+sgf.allCategories[q[w]]),p,d,m,n,e,h)}else{if(o==null||o.length==0){sgf.iterateTagHTMLElements(jQuery("."+sgf.allCategories[q[w]]),p,d,m,n,e,h,sgf.allCategories[q[w]],l,1,u,i,s)}else{var v=jQuery("."+sgf.allNewCategories[q[w]]);var b=0;var r=sgf.allNewCategories[q[w]];sgf.doIterateTagLinkText(v,b,o,p,d,m,n,e,h,r,l,u,i,s)}}}}}}else{alert("Invalid frequency. Frequency can only be either first or every")}}};sgf.doIterateTagLinkText=function(b,n,o,c,g,i,j,h,l,m,r,a,f,e){for(var q=0,d=jQuery(b).length;q<d;q++){if(jQuery(b.get(q)).prop("tagName")==o[0].toUpperCase()){n=0}else{if(n==0){sgf.iterateTagHTMLElements(jQuery(b).get(q),c,g,i,j,h,l,m,r,1,a,f,e)}else{var p=jQuery(b.get(q)).find(o[0].toUpperCase());if(p.length>0){sgf.iterateTagHTMLElements(jQuery(b).get(q),c,g,i,j,h,l,m,r,1,a,f,e)}else{sgf.iterateTagHTMLElements(jQuery(b).get(q),c,g,i,j,h,l,m,r,2,a,f,e)}}n++}}};sgf.doLinkText=function(n,e,b,d,h,i,j){var l="";var f={};var a=new Array();for(var m=0;m<b.length;m++){a.push(b[m])}if(a.length>0){if(h!="undefined"&&(h=="first"||h=="every")){if(h=="first"){i=1}if(i=="undefined"||i==""||i==null){i=1}if(jQuery.inArray("all",d)!=-1){if(n===null){n=jQuery("."+sgf.allCategories.all)}sgf.iterateHTMLElements(n,a,e,h,i,f,j)}else{if(n!==null){sgf.iterateHTMLElements(n,a,e,h,i,f,j)}else{for(var g=0;g<d.length;g++){sgf.iterateHTMLElements(jQuery("."+sgf.allCategories[d[g]]),a,e,h,i,f,j)}}}}else{alert("Invalid frequency. Frequency can only be either first or every")}}};sgf.iterateTagHTMLElements=function(z,A,n,p,r,d,x,u,o,h,w,m,v){var t="svDoNotLink";if(sciverseObj.contextInfo.LinkTextClassesToIgnore){t+=","+sciverseObj.contextInfo.LinkTextClassesToIgnore}var C="";var b=t.split(",");for(var B=0;B<b.length;B++){var l=b[B];if(C==""){C='[class*="'+l+'"]'}else{C+=',[class*="'+l+'"]'}}if(h==1){for(var s=0;s<A.length;s++){d[A[s].toLowerCase()]=0}}if(jQuery(z).hasClass("svArticle")||jQuery(z).hasClass("svAbstract")||jQuery(z).hasClass("svRefs")||jQuery(z).hasClass("keyword")||jQuery(z).hasClass("svKeywords")||jQuery(z).hasClass("svTitle")||jQuery(z).hasClass("svAuthor")){for(var g=0,j=jQuery(z).length;g<j;g++){var e=sgf.getTextNodesIn(jQuery(z).get(g));for(var q=0;q<o.length;q++){var D=o[q];if(jQuery(jQuery(z).get(g)).is(D)||jQuery(jQuery(z).get(g)).hasClass(D)){sgf.iterateTextNode(e,A,d,p,r,n,x,w,m,v)}else{var a=jQuery(jQuery(z).get(g)).find(D);if(a.length==0){a=jQuery(jQuery(z).get(g)).find("."+D)}for(var i=0;i<a.length;i++){if(jQuery(a.get(i)).is(D)||jQuery(a.get(i)).hasClass(D)){var y=sgf.getTextNodesIn(a.get(i));sgf.iterateTextNode(y,A,d,p,r,n,x,w,m,v)}}}}}}};sgf.iterateTextNode=function(f,E,e,q,r,p,C,z,n,x){var t="svDoNotLink";if(sciverseObj.contextInfo.LinkTextClassesToIgnore){t+=","+sciverseObj.contextInfo.LinkTextClassesToIgnore}var G="";var a=t.split(",");for(var F=0;F<a.length;F++){var m=a[F];if(G==""){G='[class*="'+m+'"]'}else{G+=',[class*="'+m+'"]'}}for(var y=0,B=f.length;y<B;y++){var u=jQuery(f[y]);var o=u.text();var D;var w=new BufferText("");var j="";for(var s=0;s<E.length;s++){if(!(e[E[s].toLowerCase()]>=1)){e[E[s].toLowerCase()]=0}if(!x||x==null){j=j+"|\\b"+E[s]+"\\b"}else{j=j+"|(?:^|\\s)(?:[,|\\-|:|\\?|.|\\(|'])?"+E[s]+"(?:[,|\\-|:|\\?|.|\\)|'])?(?:$|\\s)"}}j=j.substr(1,j.length);patternSelector=new PatternSelector(o,j,"ig");while(patternSelector.findPattern()){D=document.createElement("div");var h;var d=patternSelector.getMatchedPattern();var A=d;var g=new RegExp("(^[,|.|:|?|(|-])|([,|.|:|?|)|-]$)","g");var v=d.toLowerCase();var l=v;l=(l.trim()).replace(g,"");e[l]+=1;if((q==="first"&&e[l]==1)||(q==="every"&&(r==1||e[l]==1||e[l]%r==1))){if(sgf.termListeners[v]&&!sgf.isListener(p,v)){var b=new Object();b.frame=p;b.callback=C;sgf.termListeners[v].push(b)}else{if(jQuery(u.parents("a")).length==0&&jQuery(u.parents(G)).length==0&&n==true){if(z==null||(z!=null&&Object.keys(JSON.parse(z)).length==0)){if(!x||x==null){patternSelector.appendReplacement(w,"<a class='linkText' onclick='notifyWikiGadgets(\""+A.replace(/'/g,"&#39;")+'",event,"'+C+'","'+x+"\")' onmouseover=\"className='linkTextClicked';\" onmouseout=\"className='linkText';\" href='javascript:void(0);' style='cursor:pointer;cursor:hand;'>"+d+"</a>")}else{patternSelector.appendReplacementWithoutBoundary(w,"<a class='linkText' onclick='notifyWikiGadgets(\""+A.replace(/'/g,"&#39;")+'",event,"'+C+'","'+x+"\")' onmouseover=\"className='linkTextClicked';\" onmouseout=\"className='linkText';\" href='javascript:void(0);' style='cursor:pointer;cursor:hand;'>"+d+"</a>")}}else{jQuery.each(JSON.parse(z),function(i,I){var H=new RegExp("(^[,|.|:|?|(|-])|([,|.|:|?|)|-]$)","g");var J=d;var c=v;if(x){J=(d.trim()).replace(H,"");c=(v.trim()).replace(H,"")}if(J==i||c==i){h=I}});if(!x||x==null){patternSelector.appendReplacement(w,"<a class='linkText' onclick='notifyWikiGadgets(\""+A.replace(/'/g,"&#39;")+'",event,"'+C+'","'+x+'");return false\' onmouseover="className=\'linkTextClicked\';" onmouseout="className=\'linkText\';" href="'+h+"\" style='cursor:pointer;cursor:hand;'>"+d+"</a>")}else{patternSelector.appendReplacementWithoutBoundary(w,"<a class='linkText' onclick='notifyWikiGadgets(\""+A.replace(/'/g,"&#39;")+'",event,"'+C+'","'+x+'");return false\' onmouseover="className=\'linkTextClicked\';" onmouseout="className=\'linkText\';" href="'+h+"\" style='cursor:pointer;cursor:hand;'>"+d+"</a>")}}if(!sgf.isListener(p,v)){sgf.termListeners[v]=new Array();var b=new Object();b.frame=p;b.callback=C;sgf.termListeners[v].push(b)}}else{if(!x||x==null){patternSelector.appendReplacement(w,d)}else{patternSelector.appendReplacementWithoutBoundary(w,d)}if(n==false){if(!sgf.isListener(p,v)){sgf.termListeners[v]=new Array();var b=new Object();b.frame=p;b.callback=C;sgf.termListeners[v].push(b)}}}}}else{if(!x||x==null){patternSelector.appendReplacement(w,d)}else{patternSelector.appendReplacementWithoutBoundary(w,d)}}}if(w.toString().length>0){D.innerHTML=patternSelector.appendTail(w);if(jQuery(u).parent().is("a")&&n==false&&jQuery(u.parents(".linkText")).length>0){jQuery(u).unwrap()}jQuery(u).before(jQuery(D).contents());jQuery(u).remove()}}};sgf.iterateHTMLElements=function(y,A,n,o,p,e,x){var r="svDoNotLink";if(sciverseObj.contextInfo.LinkTextClassesToIgnore){r+=","+sciverseObj.contextInfo.LinkTextClassesToIgnore}var C="";var a=r.split(",");for(var B=0;B<a.length;B++){var l=a[B];if(C==""){C='[class*="'+l+'"]'}else{C+=',[class*="'+l+'"]'}}if(jQuery(y).hasClass("svArticle")||jQuery(y).hasClass("svAbstract")||jQuery(y).hasClass("svKeywords")){for(var g=0,j=jQuery(y).length;g<j;g++){var f=sgf.getTextNodesIn(jQuery(y).get(g));for(var v=0,w=f.length;v<w;v++){var s=jQuery(f[v]);var m=s.text();var z;var u=new BufferText("");var h="";for(var q=0;q<A.length;q++){if(!(e[A[q].toLowerCase()]>=1)){e[A[q].toLowerCase()]=0}h=h+"|\\b"+A[q]+"\\b"}h=h.substr(1,h.length);patternSelector=new PatternSelector(m,h,"ig");while(patternSelector.findPattern()){z=document.createElement("div");var d=patternSelector.getMatchedPattern();var t=d.toLowerCase();e[t]+=1;if((o==="first"&&e[t]==1)||(o==="every"&&(p==1||e[t]==1||e[t]%p==1))){if(sgf.termListeners[t]&&!sgf.isListener(n,t)){var b=new Object();b.frame=n;b.callback=x;sgf.termListeners[t].push(b)}else{if(jQuery(s.parents("a")).length==0&&jQuery(s.parents(C)).length==0){patternSelector.appendReplacement(u,"<a class='linkText' onclick='notifyGadgets(\""+d.replace(/'/g,"&#39;")+"\",event)' onmouseover=\"className='linkTextClicked';\" onmouseout=\"className='linkText';\" href='javascript:void(0);' style='cursor:pointer;cursor:hand;'>"+d+"</a>");if(!sgf.isListener(n,t)){sgf.termListeners[t]=new Array();var b=new Object();b.frame=n;b.callback=x;sgf.termListeners[t].push(b)}}else{patternSelector.appendReplacement(u,d)}}}else{patternSelector.appendReplacement(u,d)}}if(u.toString().length>0){z.innerHTML=patternSelector.appendTail(u);jQuery(s).before(jQuery(z).contents());jQuery(s).remove()}}}}else{var f=sgf.getTextNodesIn(jQuery(y).get(0));for(var v=0,w=f.length;v<w;v++){var s=jQuery(f[v]);var m=s.text();var z;var u=new BufferText("");var h="";for(var q=0;q<A.length;q++){if(!(e[A[q].toLowerCase()]>=1)){e[A[q].toLowerCase()]=0}h=h+"|\\b"+A[q]+"\\b"}h=h.substr(1,h.length);patternSelector=new PatternSelector(m,h,"ig");while(patternSelector.findPattern()){z=document.createElement("div");var d=patternSelector.getMatchedPattern();var t=d.toLowerCase();e[t]+=1;if((o==="first"&&e[t]==1)||(o==="every"&&(p==1||e[t]==1||e[t]%p==1))){if(sgf.termListeners[t]&&!sgf.isListener(n,t)){var b=new Object();b.frame=n;b.callback=x;sgf.termListeners[t].push(b)}else{if(jQuery(s.parents("a")).length==0&&jQuery(s.parents(C)).length==0){patternSelector.appendReplacement(u,"<a class='linkText' onclick='notifyGadgets(\""+d.replace(/'/g,"&#39;")+"\",event)' onmouseover=\"className='linkTextClicked';\" onmouseout=\"className='linkText';\" href='javascript:void(0);' style='cursor:pointer;cursor:hand;'>"+d+"</a>");if(!sgf.isListener(n,t)){sgf.termListeners[t]=new Array();var b=new Object();b.frame=n;b.callback=x;sgf.termListeners[t].push(b)}}else{patternSelector.appendReplacement(u,d)}}}else{patternSelector.appendReplacement(u,d)}}if(u.toString().length>0){z.innerHTML=patternSelector.appendTail(u);jQuery(s).before(jQuery(z).contents());jQuery(s).remove()}}}};sgf.getTextNodesIn=function(d,a){var c=[];function b(g){if(g==null){return}if(g.nodeType==3){if(a||!/^\s*$/.test(g.nodeValue)){c.push(g)}}else{for(var f=0,e=g.childNodes.length;f<e;++f){b(g.childNodes[f])}}}b(d);return c};var addAllButtonResults={};var buttonsJsonList;var buttonCounter=-1;shindig.SciverseService.prototype.addButtons=function(h,j,g){var b={};if(typeof(resultList)===undefined||resultList===null){return b}var a=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var c=shindig.container.getGadget(a);var e=this.f;if(h!=null&&h.length>0){jQuery.each(h,function(l,m){b=loadButtons(m,e,c.sciverseId_,j,b,g)})}else{if(h==null){for(var d=0;d<resultList.length;d++){var f=resultList[d].offset;f=parseInt(f);if(f!=null){b=loadButtons(f,e,c.sciverseId_,j,b,g)}}}}return b};function loadButtons(b,d,a,h,g,e){var f=[];var c=[];if(addAllButtonResults[a+"_"+b]!=undefined||addAllButtonResults[a+"_"+b]!=null){c=addAllButtonResults[a+"_"+b]}if(jQuery("#buttons_"+b).length==0){return g}jQuery("#buttons_"+b).addClass("addButtonsGadget");jQuery.each(h,function(i,j){buttonCounter++;c.push("button_"+a+"_"+buttonCounter);f.push(buttonCounter);addAllButtonResults[a+"_"+b]=c;g[b]=f;jQuery("#buttons_"+b).append('<span id="button_'+a+"_"+buttonCounter+'" class="addButtonsImgGadget"><a href="javascript:void(0);" onclick="notifyButtonGadgets(\''+d+"',"+b+","+buttonCounter+",'"+e+'\',event);"><img src="'+j.imageUrl+'" height="15" alt="'+j.altText+'"  title="'+j.altText+'"/></a></span>')});return g}shindig.SciverseService.prototype.removeButtons=function(a,g){if(typeof(resultList)===undefined||resultList===null){return}var h=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var f=shindig.container.getGadget(h);var e=[];if(addAllButtonResults!=null){if((a==null||a.length==0)&&(g==null||g.length==0)){for(var c=0;c<resultList.length;c++){var d=resultList[c].offset;if(d!=null){d=parseInt(d);e=addAllButtonResults[f.sciverseId_+"_"+d];if(e!=null){for(var b=0;b<e.length;b++){jQuery("#"+e[b]).remove()}}delete addAllButtonResults[f.sciverseId_+"_"+d]}}}else{if(a!=null&&a.length>0&&g!=null&&g.length>0){for(var c=0;c<a.length;c++){if((jQuery("#buttons_"+a[c]).length>0)){e=addAllButtonResults[f.sciverseId_+"_"+a[c]];if(e!=null||e!=undefined){e=removeButtonIDFromMap(g,e,f.sciverseId_);addAllButtonResults[f.sciverseId_+"_"+a[c]]=e}}}}else{if(a==null&&g!=null&&g.length>0){for(var c=0;c<resultList.length;c++){var d=resultList[c].offset;if(d!=null){d=parseInt(d);e=addAllButtonResults[f.sciverseId_+"_"+d];if(e!=null||e!=undefined){e=removeButtonIDFromMap(g,e,f.sciverseId_);addAllButtonResults[f.sciverseId_+"_"+d]=e}}}}else{if(a!=null&&a.length>0&&g==null){for(var c=0;c<a.length;c++){if((jQuery("#buttons_"+a[c]).length>0)){e=addAllButtonResults[f.sciverseId_+"_"+a[c]];if(e!=null){for(var b=0;b<e.length;b++){jQuery("#"+e[b]).remove()}}delete addAllButtonResults[f.sciverseId_+"_"+a[c]]}}}}}}}};function removeButtonIDFromMap(f,e,a){for(var d=0;d<f.length;d++){if(jQuery("#button_"+a+"_"+f[d]).length>0){jQuery("#button_"+a+"_"+f[d]).remove()}for(var c=0;c<e.length;c++){var b="button_"+a+"_"+f[d];if(b==e[c]){e.splice(c,1)}}}return e}shindig.SciverseService.prototype.getSubjectAreas=function(a){sgf.getSubjectAreas(this.f,a)};shindig.SciverseService.prototype.getContent=function(a){sgf.getContent(this.f,a)};shindig.SciverseService.prototype.getSubType=function(a){sgf.getSubType(this.f,a)};shindig.SciverseService.prototype.invokeColumnView=function(b,a){if(HUB.setColAppLoc){HUB.setColAppLoc()}if(sciverseObj.contextInfo.pageType=="library"){if(sciverseObj.contextInfo.currentView=="documents"){b="Doc_"+b}else{if(sciverseObj.contextInfo.currentView=="searches"){b="Srch_"+b}}}if(jQuery("#columnView_"+b).length==0){return false}var g=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var e=shindig.container.getGadget(g);jQuery("#columnView_"+b).show();var d="columnView_"+b;if(jQuery("#columnView"+b+"_"+e.sciverseId_).length!==0){return false}shindig.container.layoutManager=new shindig.FloatLeftLayoutManager(d);var f=shindig.container.createGadget({specUrl:e.specUrl,title:e.title,userPrefs:this.userPrefs,requiresPubSub2:this.requiresPubSub2});f.sciverseId_=e.sciverseId_;f.iconURL=e.iconURL;f.location="columnView"+b;shindig.container.addGadget(f);var c=shindig.container.layoutManager.getGadgetChrome(f);f.prepareGadgetForView("sciverseColumnView",c,a)};shindig.SciverseService.prototype.executeSearch=function(g){var i=[];var f=[];var c="";var d="";var a;var b;var e;var h;if(typeof(g)=="undefined"||g==null||g==""){return}a=sciverseObj.smapiVars.searchQueryURL;b=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);e=shindig.container.getGadget(b);h=e.sciverseId_;d=sciverseObj.contextInfo.platform;if(d==="SC"){c="&searchfield=";i.push("&gadgetId=",h);i.push("&origin=",sciverseObj.contextInfo.originPage)}else{if(d==="SVH"){c="?st="}else{if(d==="SD"){c="&gadgetST=";i.push("&gadgetID=",h)}}}f.push(a,c,g,i);window.location=a};shindig.SciverseService.prototype.executeSDSearch=function(b){if(typeof(b)=="undefined"||b==null||b==""){return}var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var d=shindig.container.getGadget(e);var a=d.sciverseId_;var c=sciverseObj.smapiVars.sdSearchQueryURL;c+="?query="+b;c+="&gadgetID="+a;window.open(c)};shindig.SciverseService.prototype.executeSCSearch=function(b){if(typeof(b)=="undefined"||b==null||b==""){return}var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var d=shindig.container.getGadget(e);var a=d.sciverseId_;var c=sciverseObj.smapiVars.scSearchQueryURL;c+="&searchfield="+b;c+="&gadgetId="+a;c+="&origin="+sciverseObj.contextInfo.originPage;window.open(c)};shindig.SciverseService.prototype.executeHubSearch=function(a){if(typeof(a)=="undefined"||a==null||a==""){return}var b=sciverseObj.smapiVars.hubSearchQueryURL;b+="?st="+a;window.open(b)};shindig.SciverseService.prototype.entitleGadget=function(e){var c={};var f="";if(sciverseObj.contextInfo.individualUser=="true"){f="INDIVIDUAL"}var d=decodeURIComponent((e.gadgetName).replace(/\+/g," "));c={userInfo:{authToken:"",userAnonymity:f,sessionId:sciverseObj.contextInfo.sessionId,sessionAffinity:sciverseObj.contextInfo.sessionAffinity,pathId:sciverseObj.contextInfo.pId,siteIdentifier:sciverseObj.contextInfo.siteIdentifier},reqGadgetInfo:{gadgetID:e.gadgetID,gadgetName:d},securedAuthToken:sciverseObj.contextInfo.secureAuthtoken,platformCode:sciverseObj.contextInfo.platform};if(sciverseObj.contextInfo.platform=="SD"){c.contentFilteringInfo=loadSDContentFilteringInfo()}var b=gadgets.json.stringify(c);var a=new Array();a.push(sciverseObj.smapiVars.gsUrl);a.push("/rest/gs/addGadgetEntitlement");jQuery.ajax({url:a.join(""),type:"POST",data:b,async:false,success:function(g){handleEntitlementResponse(g)}})};shindig.SciverseService.prototype.getEuidCookie=function(){if(typeof SDM!=="undefined"&&typeof SDM.svapi!=="undefined"&&typeof SDM.svapi.getEuid==="function"){return SDM.svapi.getEuid()}return null};shindig.IfrContainer.prototype.SciverseService=new shindig.SciverseService();function loadSDContentFilteringInfo(){var c=new Array();for(var a in sciverseObj.locationsOnPage){c.push(a)}var b={issn:sciverseObj.contextInfo.issn,isbn:sciverseObj.contextInfo.isbn,startVolume:sciverseObj.contextInfo.startVolume,endVolume:sciverseObj.contextInfo.endVolume,startIssue:sciverseObj.contextInfo.startIssue,endIssue:sciverseObj.contextInfo.endIssue,subjectCategories:sciverseObj.contextInfo.subjectCategories,locationsOnPage:c};return b}function handleEntitlementResponse(a){responseObj=gadgets.json.parse(a);if(responseObj.responseCode=="200"){prependEntitledGadgetToLocation(responseObj.gadgetInfos)}else{}}function isLocatiionMappedtoPage(a){var b=false;for(k in sciverseObj.locationsOnPage){if(k==a){b=true;break}}return b}function prependEntitledGadgetToLocation(i){if(sciverseObj.contextInfo.pageType=="home"){window.location.reload();return}shindig.container.layoutManager=new shindig.FloatLeftLayoutManager();var a=false;var l=false;var f=false;for(var b in i){var j=i[b];for(var g in j.views){if(g=="canvas"){f=true}if(g=="hover"){l=true;break}}for(var m=0;m<=j.location.length;m++){if(isLocatiionMappedtoPage(j.location[m])){var d=true;var e=true;if(jQuery("#"+j.location[m]).hasClass("sgfNoTitleBar")){d=false}if(jQuery("#"+j.location[m]).hasClass("sgfNoGadgetBorder")){e=false}if(jQuery("#"+j.location[m]).hasClass("sgfShowMyApps")||jQuery("#"+j.location[m]).hasClass("sgfHorToolbar")||jQuery("#"+j.location[m]).hasClass("sgfVertToolbar")){shindig.container.layoutManager.layoutRootId_="toolbar_"+j.location[m]}else{shindig.container.layoutManager.layoutRootId_=j.location[m]}if(debug){debugArea=shindig.container.layoutManager.getGadgetDebugChrome(j.gadgetId,j.location[m])}gadgetHeightFromPrefs=(typeof(j.height)!="undefined"&&j.height!=null&&j.height!=0)?j.height:null;userPrefs=j.userPreferences;if(userPrefs!=null){var h=gadgets.json.stringify(userPrefs);h=convertFromHtmlEntities(h);userPrefs=gadgets.json.parse(h)}if(typeof(userPrefs)!="undefined"&&userPrefs!=null&&typeof(userPrefs.startMeInvisible)!="undefined"&&userPrefs.startMeInvisible!=null){if(userPrefs.startMeInvisible.value=="y"){a=true}}var c=shindig.container.createGadget({specUrl:j.url,title:j.gadgetName,userPrefs:userPrefs,height:gadgetHeightFromPrefs,requiresPubSub2:j.requiresPubSub2});c.sciverseId_=j.gadgetId;c.open=j.open[j.location[m]];c.includeTitle=d;c.isExtendedAreaApp=false;c.includeBorder=e;c.location=j.location[m];c.isCanvasViewAvailable=f;c.isHoverViewAvailable=l;c.isStartMeInvisible=a;c.removable=j.removable;c.prependToLocation=true;c.iconURL=(j.gadgetIcon==null||j.gadgetIcon=="")?gadgetIconPath+"/netbase.gif":j.gadgetIcon;c.hasUserPrefs=j.hasUserPrefs;log(c.sciverseId_,c.location,"gadget created");shindig.container.addGadget(c);log(c.sciverseId_,c.location,"gadget added");shindig.container.renderGadget(c);saveToolBarState(g_toolbarState,"prependNewGadget",null,false,j.location[m],getGadgetOrder(j.location[m]),showMoreApps)}}}}function notifyGadgets(e,c){if(!c){c=window.event}if(!c.target&&c.srcElement){c.target=c.srcElement}var f=getMouseClickCoordinates(c);var b=sgf.termListeners[e.toLowerCase()];for(var d=0,a=b.length;d<a;d++){gadgets.rpc.call(b[d].frame,b[d].callback,null,e,f.x,f.y)}}function notifyWikiGadgets(b,h,j,e){var g=b;var a=new RegExp("(^[,|.|:|?|(|-])|([,|.|:|?|)|-]$)","g");if(!h){h=window.event}if(!h.target&&h.srcElement){h.target=h.srcElement}var l=getMouseClickCoordinates(h);var d=sgf.termListeners[b.toLowerCase()];for(var c=0,f=d.length;c<f;c++){if(e){g=(g.trim()).replace(a,"");console.log("replaced pattern from notify "+g)}gadgets.rpc.call(d[c].frame,j,null,g,l.x,l.y)}}function notifyButtonGadgets(c,a,b,e,d){if(!d){d=window.event}if(!d.target&&d.srcElement){d.target=d.srcElement}var f=getMouseClickCoordinates(d);gadgets.rpc.call(c,e,null,a,b,f.x,f.y)}sgf.isListener=function(e,d){if(typeof(sgf.termListeners[d])=="undefined"){return false}var b=sgf.termListeners[d];for(var c=0,a=b.length;c<a;c++){if(b[c].frame==e){return true}}return false};function getMouseClickCoordinates(b){var a=0;var c=0;a=jQuery(b.target).offset().left+jQuery(b.target).outerWidth();c=jQuery(b.target).offset().top;return{x:a,y:c}}function PatternSelector(c,b,a){this._text=""+c;this._expression=new RegExp(b,a);this._indexOfTail=0;this.reset();return}PatternSelector.prototype={_appendText:function(a,b){return((a)?a.append(b):b)},appendReplacement:function(f,j){var g=new RegExp("\\b"+this._patternMatchList[0]+"\\b");var e=this._prevPatternEnd;var d=this._text.substring(this._prevPatternEnd);var i=d.search(g);var h=this._text.substring(e,i+e);h=h+j;this._indexOfTail=e+i+this._patternMatchList[0].length;return((this._patternMatchList!=null)?this._appendText(f,h):f)},appendReplacementWithoutBoundary:function(e,j){var h=(this._patternMatchList[0]).trim();var f=h.substring(h.length-1,h.length);var n=h.substring(0,1);if(n=="("){h="["+n+"]"+h.substring(1,h.length)}if(f=="?"||f=="."||f==")"){h=h.substring(0,h.length-1)+"["+f+"]"}var d=new RegExp("(?:^|\\s)(?:[,|\\-|:|\\?|.|\\(|'])?"+h+"(?:[,|\\-|:|\\?|.|\\)|'])?(?:$|\\s)");var m=this._prevPatternEnd;var l=this._text.substring(this._prevPatternEnd);var i=l.search(d);if(i<0){console.log("Returning buffer since  pattern not found "+e);return e}var g=this._text.substring(m,i+m);g=g+j;this._indexOfTail=m+i+this._patternMatchList[0].length;return((this._patternMatchList!=null)?this._appendText(e,g):e)},appendTail:function(a){return(this._appendText(a,this._text.substring(this._indexOfTail)))},findPattern:function(){this._prevPatternEnd=this._expression.lastIndex;this._patternMatchList=this._expression.exec(this._text);return(this._patternMatchList!=null)},getMatchedPattern:function(a){return(this._patternMatchList!=null?this._patternMatchList[0]:"")},reset:function(a){this._patternMatchList=null;this._prevPatternEnd=-1;return}};function BufferText(a){this.buffer=(typeof(a)=="string")?new Array(a):new Array();return}BufferText.prototype={append:function(a){this.buffer.push(a);return(this)},toString:function(){return(this.buffer.join(""))}};var isKeyEventURLExists;var isGadgetRemoveURLExists;var toolbarOrientation;var toolbarWidth;var vertToolbarWidth;var tbWidthwithoutImage;var toolbarImgWidth=21;var VERTICAL_TOOLBAR_WIDTH=332;var submenuID;var submenuID1;var subMenuIdBuf;var debug=false;if(document.location.href.indexOf("debug=y")>0){debug=true}var gadgetPrefs={};var sciverseObj;var isUserEntitledtoGadgets;var isScopusIE7=false;var isExtendedAreaEnabled;var showMoreApps;var g_toolbarState;var gadgetIconPath;var gadgetJSPath;var releaseNumber="v8";var userPrefs;var browserVersion=navigator.appVersion;var MSIE7Flag;if(browserVersion.indexOf("MSIE 7.0")>0){MSIE7Flag=true}var MSIE10Flag;if(browserVersion.indexOf("MSIE 10.0")>0){MSIE10Flag=true}else{MSIE10Flag=false}var sgftoggleState=0;var truncateURL;if(browserVersion.indexOf("IE")>0){truncateURL=true}var browser="";if(navigator.userAgent.indexOf("Firefox")>-1){browser="FF"}if(navigator.userAgent.indexOf("MSIE")>-1){browser="IE"}if(navigator.userAgent.indexOf("Chrome")>-1){browser="Chrome"}var sgf=sgf||{};sgf.labels={aboutApp:"About This App",close:"Close",closeApp:"Close This Application",editPrefs:"Edit Preferences",hideRightColum:"Hide Right Column",moveApp:"Move Application",moveDown:"Move DOWN",moveUp:"Move UP",noApps:"You currently have no applications",openApp:"Open This Application",openCanvas:"Open Application To Full-Screen Mode",openOptions:"Open Options",pin:"Pin",showFew:"Show fewer applications",showMore:"Show more applications",showRightColumn:"Show Right Column",turnOff:"Turn Off",turnOn:"Turn On",unpin:"Unpin"};var homePageToolbarHtml=new Array();homePageToolbarHtml.push('<div class="toolbarfootFull" align="justify">');homePageToolbarHtml.push('	<div class="toolbarBodyFull">');homePageToolbarHtml.push('		<div class="toolbarHeadFull">');homePageToolbarHtml.push('			<div id="ErrormessageDiv" style="text-align: center; width: 100%; display: none;"></div>');homePageToolbarHtml.push('			<div id="column0" class="col1 connectedSortable"></div>');homePageToolbarHtml.push('			<div id="column1" class="col2 connectedSortable"></div>');homePageToolbarHtml.push('			<div id="column2" class="col3 connectedSortable"></div>');homePageToolbarHtml.push("		</div>");homePageToolbarHtml.push("	</div>");homePageToolbarHtml.push("</div>");var homePageToolbarHtmlStr=homePageToolbarHtml.join("");var toolbarHtml=new Array();toolbarHtml.push('<div id="sciverse_toolbar" class="sgfSciverseVertToolBar">');toolbarHtml.push('	<div class="toolbarfoot">');toolbarHtml.push('		<div class="toolbarBody" id="toolbarBody">');toolbarHtml.push('			<div id="toolbar" class="sgfInnerToolbar" style="width: 97%; min-height: 155px; text-align: center; margin: 5px auto;"></div>');toolbarHtml.push('			<div id="showMoreApps">');toolbarHtml.push('				<a onclick="showMore()" class="plusSign">+</a>');toolbarHtml.push('				<a id="showMore" onclick="showMore()" class="showMoreLessApps">Show more applications</a>');toolbarHtml.push("			</div>");toolbarHtml.push('			<div id="showLessApps">');toolbarHtml.push('				<a onclick="showLess()" class="plusSign">-</a>');toolbarHtml.push('				<a id="showFew" onclick="showLess()" class="showMoreLessApps">Show fewer applications</a>');toolbarHtml.push("			</div>");toolbarHtml.push("		</div>");toolbarHtml.push("	</div>");toolbarHtml.push("</div>");toolbarHtml.push('<div class="sgfToolBarToggleImage">');toolbarHtml.push('	<div id="sgfSlideBar" class="sgfSideCollapse" onmouseout="sgfToggleToolBarOut();" onmouseover="sgfToggleToolBarOver();" title="'+decodeURIComponent(sgf.labels.hideRightColumn)+'"></div>');toolbarHtml.push('	<div class="clear"></div>');toolbarHtml.push("</div>");var toolbarHtmlStr=toolbarHtml.join("");var eventSubscriptionList=new Array();sgf.renderGadgetsHome=function(m){if(jQuery("#column0").length==0||jQuery("#column1").length==0||jQuery("#column2").length==0){return false}sgf.isUserEntitled();sgf.isKeyEventURLAvailable();var c;if(!isUserEntitledtoGadgets){var i=jQuery("#ErrormessageDiv");i.css("display","block");i.html(sgf.labels.noApps);return}gadgets.pubsub2router.init({onSubscribe:function(o,n){return true},onUnsubscribe:function(o,n){log(n.getClientID()+" unsubscribes from topic '"+o+"'")},onPublish:function(o,p,n,q){return true}});var l=-1;shindig.container.layoutManager=new shindig.FloatLeftLayoutManager();var d=new Array();var f=sciverseObj.locationsOnPage[m].gadgets;var a={};var h=jQuery("#"+m);if(h!=undefined&&h!=null&&h.attr("class")!=undefined&&h.attr("class")!=null){a=h.attr("class").split(" ")}var b=null;for(var j=0;j<a.length;j++){if(a[j].indexOf("preferredView")>-1){var e=a[j];b=e.split("=",2)[1]}}var g=false;if(h.hasClass("sgfShowChromeOnHover")){g=true}jQuery.each(f,function(x,o){var u=sciverseObj.gadgetInfos[o];if(u==""||u==null||u=="undefined"){l=l+1;if(l%3==0){l=0}}else{var v=false;var n=false;var q=false;var t=false;for(var r in u.views){if(r=="canvas"){q=true}if(r=="hover"){v=true}if(b!=null&&r==b){t=true}}l=l+1;if(l%3==0){l=0}if(m=="sgfGhost"){shindig.container.layoutManager.layoutRootId_="sgfGhost"}else{shindig.container.layoutManager.layoutRootId_="column"+l}c=(typeof(u.height)!="undefined"&&u.height!=null&&u.height!=0)?u.height:null;if(debug){debugArea=shindig.container.layoutManager.getGadgetDebugChrome(u.gadgetId,m)}userPrefs=u.userPreferences;if(userPrefs!=null){var s=gadgets.json.stringify(userPrefs);s=convertFromHtmlEntities(s);userPrefs=gadgets.json.parse(s)}if(typeof(userPrefs)!="undefined"&&userPrefs!=null&&typeof(userPrefs.startMeInvisible)!="undefined"&&userPrefs.startMeInvisible!=null){if(userPrefs.startMeInvisible.value=="y"){n=true}}var p=shindig.container.createGadget({specUrl:u.url,title:u.gadgetName,userPrefs:userPrefs,height:c,requiresPubSub2:u.requiresPubSub2});p.sciverseId_=u.gadgetId;p.open=u.open[m];p.location=m;p.iconURL=(u.gadgetIcon==null||u.gadgetIcon=="")?gadgetIconPath+"/netbase.gif":u.gadgetIcon;p.removable=u.removable;p.hasUserPrefs=u.hasUserPrefs;p.isHoverViewAvailable=v;p.isStartMeInvisible=n;p.isCanvasViewAvailable=q;p.isOnhoverChromeRequired=g;if(t){p.preferredView=b}else{p.preferredView=null}shindig.container.addGadget(p);shindig.container.renderGadget(p);var w=(p.open==="N")?"close":"open";if(n){w+="|invisible"}else{w+="|visible"}if(p.open!="N"){}}});jQuery("div.AppHeaders").css("padding","7px 5px 4px 5px")};var visibleAppCount;var temptoolbarState=true;sgf.renderGadgets=function(q,w,a,p,f,d){sgf.isUserEntitled();sgf.isKeyEventURLAvailable();var e;var u;var m=jQuery("#"+q);if(p){u=(p=="showMoreLess")?true:false}if((toolbarOrientation=="vertical"&&!m.hasClass("sgfIsGadgeGator"))&&(!p)&&(!u)&&m.hasClass("sgfVertToolbar")){onLoadToolbarStateVertical(q)}if(!isUserEntitledtoGadgets){var r=jQuery("#toolbar_"+q);r.css("text-align","center");r.html(sgf.labels.noApps);return}gadgets.pubsub2router.init({onSubscribe:function(y,x){return true},onUnsubscribe:function(y,x){log(x.getClientID()+" unsubscribes from topic '"+y+"'")},onPublish:function(y,z,x,A){return true}});if(m.hasClass("sgfShowMyApps")&&m.hasClass("sgfVertToolbar")&&!temptoolbarState){return}shindig.container.layoutManager=new shindig.FloatLeftLayoutManager();var h="";var v=jQuery("#"+q+" > #sgfTabsBody > ul");var t=sciverseObj.locationsOnPage[q].gadgets;var b=(u)?visibleAppCount:0;var l=false;var o=(u)?t.length:visibleAppCount;var g={};if(m!=undefined&&m!=null&&m.attr("class")!=undefined&&m.attr("class")!=null){g=m.attr("class").split(" ")}var n=null;for(var i=0;i<g.length;i++){if(g[i].indexOf("preferredView")>-1){var s=g[i];n=s.split("=",2)[1]}}jQuery.each(t,function(I,y){var F=sciverseObj.gadgetInfos[y];if(u&&I<visibleAppCount){return}if(F==""||F==null||F=="undefined"){return}var G=false;var x=false;var A=false;var E=false;for(var B in F.views){if(B=="canvas"){A=true}if(B=="hover"){G=true}if(n!=null&&B==n){E=true}}if(m.hasClass("sgfShowMyApps")||m.hasClass("sgfHorToolbar")||m.hasClass("sgfVertToolbar")){shindig.container.layoutManager.layoutRootId_="toolbar_"+q;if(jQuery("#"+q+"_"+F.gadgetId).html()!=null){return}if(u){l=true}if(b==o&&m.hasClass("sgfShowMoreLessApps")){var C=jQuery("#showMoreApps");if(C.css("display")=="none"&&!isExtendedAreaEnabled){C.show()}if(C.css("display")=="none"&&isExtendedAreaEnabled){l=true}if(!isExtendedAreaEnabled){return}}b+=1}else{if(f){shindig.container.layoutManager.layoutRootId_="sgfTabsBody"}else{shindig.container.layoutManager.layoutRootId_=q}}if(debug){debugArea=shindig.container.layoutManager.getGadgetDebugChrome(F.gadgetId,q)}e=(typeof(F.height)!="undefined"&&F.height!=null&&F.height!=0)?F.height:null;userPrefs=F.userPreferences;if(userPrefs!=null){var D=gadgets.json.stringify(userPrefs);D=convertFromHtmlEntities(D);userPrefs=gadgets.json.parse(D)}if(typeof(userPrefs)!="undefined"&&userPrefs!=null&&typeof(userPrefs.startMeInvisible)!="undefined"&&userPrefs.startMeInvisible!=null){if(userPrefs.startMeInvisible.value=="y"){x=true}}var z=shindig.container.createGadget({specUrl:F.url,title:F.gadgetName,userPrefs:userPrefs,height:e,requiresPubSub2:F.requiresPubSub2});z.sciverseId_=F.gadgetId;z.open=(F.open[q]==="N"||(f==true&&I>0)?"N":"Y");z.includeTitle=w;z.isExtendedAreaApp=l;z.includeBorder=a;z.location=q;z.isCanvasViewAvailable=A;z.isHoverViewAvailable=G;z.isStartMeInvisible=x;if(E){z.preferredView=n}else{z.preferredView=null}z.removable=F.removable;z.iconURL=(F.gadgetIcon==null||F.gadgetIcon=="")?gadgetIconPath+"/netbase.gif":F.gadgetIcon;z.hasUserPrefs=F.hasUserPrefs;log(z.sciverseId_,z.location,"gadget created");shindig.container.addGadget(z);log(z.sciverseId_,z.location,"gadget added");shindig.container.renderGadget(z);var H=(z.open==="N")?"close":"open";if(x){H+="|invisible"}else{H+="|visible"}if(f!=true||(f==true&&I==0)){if(z.open!="N"){if(H==="open|visible"){sgf.saveEventData(F.gadgetId,sgfEvents.DISPLAY_GADGET,q,d,"")}}}jQuery('<li id="'+F.gadgetId+'" title="'+z.title+'"><a id="tab_'+z.id+'" tabindex='+I+' href="#'+q+"_"+F.gadgetId+'" onclick="sgf.openTabbedGadget(\''+z.id+"');\">"+F.gadgetName+"</a></li>").appendTo(v)});if(m.hasClass("sgfPrivilegedLocation")){var j=jQuery("#"+q).children();var c=jQuery("#"+q).children(".invisible");if(j.length>c.length){m.css("display","block");if(showLibAppCol){showLibAppCol(q)}}}sgf.setToolBarWidth()};sgf.openTabbedGadget=function(a){if(a==0){jQuery("#tab_"+a).removeAttr("onclick");return}var c=shindig.container.getGadget(a);if(c!=null){jQuery("#tab_"+a).removeAttr("onclick");var b="";if(c.requiresPubSub2){b=c.oaaIframeId}else{b=c.getIframeId()}var d=document.getElementById(b);if(d){var e=jQuery("#maincont"+b).css("display");if(e=="none"&&jQuery("#"+b).attr("src")==""){jQuery("#"+b).attr("src",c.getIframeUrl());jQuery("#maincont"+b).show()}}}};function setGlobalToolbarStateVars(){g_toolbarState=(sciverseObj.contextInfo.toolbarState.length>1)?sciverseObj.contextInfo.toolbarState:"Open";if(sciverseObj.contextInfo.toolbarState=="Close"){temptoolbarState=false}var a=jQuery(".sgfShowMoreLessApps").attr("id");if(sciverseObj.contextInfo.isViewMore=="Y"&&sciverseObj.locationsOnPage[a]!=undefined&&sciverseObj.locationsOnPage[a]!=null&&sciverseObj.locationsOnPage[a].gadgets!=undefined&&sciverseObj.locationsOnPage[a].gadgets!=null&&sciverseObj.locationsOnPage[a].gadgets.length>sciverseObj.smapiVars.visibleAppsCount){isExtendedAreaEnabled=true;showMoreApps="Y"}else{isExtendedAreaEnabled=false;showMoreApps="N"}visibleAppCount=sciverseObj.smapiVars.visibleAppsCount;if(sciverseObj.contextInfo.platform=="SC"&&sciverseObj.contextInfo.pageType=="resultslist"&&browser==="IE"&&MSIE7Flag===true){isScopusIE7=true}}function displayGadgets(){sciverseObj=gadgets.json.parse(sciverse);if(typeof(sciverseObj)=="undefined"||sciverseObj==false||sciverseObj==""){if(debug){alert("No data available to render the gadgets")}return false}if(typeof sciverseObj.smapiVars==="undefined"){return}if(typeof(setLibraryTab)!="undefined"){setLibraryTab()}sgf.processInterRefs("centerPane");sgf.setGadgetIHSURL();sgf.processMmcGadgets("centerPane");setGlobalToolbarStateVars();var f=[];for(var o in sciverseObj.locationsOnPage){var j=false;var d=true;var i=true;if(o=="sgfGhost"){if(!(jQuery("#sgfGhost").length>0)){jQuery('<div id="sgfGhost" style="display:none;"></div>').appendTo(jQuery("body"))}}var a=jQuery("#"+o);if(a.length==0){continue}if(a.hasClass("sgfTabsToolbar")){i=false;d=false;var m=a.data("closeCallback");var l=sciverseObj.smapiVars.gsUrl+"/gadgets/"+releaseNumber+"/images/advqb_close-btn.png";jQuery('<div id="builderClose" style="padding-bottom:18px;"><img style="margin:5px;float: right;" id="imageUrl"/></div>').appendTo(a);jQuery("#imageUrl").attr("src",l);jQuery('<div id="sgfTabsBody"><ul></ul></div>').appendTo(a);sgf.renderGadgets(o,i,d,"",true);jQuery("#"+o+" #sgfTabsBody").tabs();jQuery("#imageUrl").click(function(){m()});continue}if(a.hasClass("sgfHomePage")){var e=decodeURIComponent(sgf.labels.help);a.html(homePageToolbarHtmlStr);sgf.renderGadgetsHome(o);setTimeout("adjustColHeight()",10000);if(browser!=="FF"){applysortableForHomePage(o)}var n=(checkCompliance()=="Quirks")?true:false;if(n){jQuery(".Controls").css("position","")}else{jQuery(".Controls").css("position","relative")}continue}if(a.hasClass("sgfVertToolbar")||a.hasClass("sgfHorToolbar")||a.hasClass("sgfShowMyApps")){a.html(toolbarHtmlStr);var e=decodeURIComponent(sgf.labels.help);var b=decodeURIComponent(sgf.labels.showMore);var g=decodeURIComponent(sgf.labels.showFew);jQuery("#showMore").attr("title",b).html(b);jQuery("#showFew").attr("title",g).html(g);setTimeout("adjustColHeight()",10000);jQuery("#toolbar").attr("id","toolbar_"+o);if(a.hasClass("sgfVertToolbar")){toolbarOrientation="vertical";jQuery("#"+o).children("#toggleImg").css("display","block");toolbarWidth=VERTICAL_TOOLBAR_WIDTH;tbWidthwithoutImage=(toolbarWidth-toolbarImgWidth);toolbarWidth+="px";tbWidthwithoutImage+="px";a.find("#horiToolbarControls").show()}if(a.hasClass("sgfHorToolbar")){toolbarOrientation="horizontal";a.children(".sgfToolBarToggleImage").css("display","none");a.find("#toolbarBody").removeClass("toolbarBody");a.find("#toolbarBody").addClass("toolbarBodyHorizontal");a.children("#sciverse_toolbar").removeClass("sgfSciverseVertToolBar");a.children("#sciverse_toolbar").addClass("sgfSciverseHoriToolBar");a.find("#horiToolbarControls").show()}sgf.renderGadgets(o,i,d,null,false,f);if(jQuery("#showLessApps").css("display")=="none"&&isExtendedAreaEnabled&&a.hasClass("sgfShowMoreLessApps")){jQuery("#showLessApps").show()}if(browser!=="FF"){sgf.applySortable(o)}else{sgf.resetTitleStyles(o)}}else{if(toolbarOrientation=="vertical"){toolbarWidth="100%"}if(o!=undefined&&o!=null&&o=="SVH_SR2"){toolbarWidth=""}if(a.hasClass("sgfNoTitleBar")){i=false}if(a.hasClass("sgfNoGadgetBorder")){d=false}sgf.renderGadgets(o,i,d,null,false,f);if(browser!=="FF"){sgf.applySortable(o)}else{sgf.resetTitleStyles(o)}}}var c=checkCompliance();if(c=="Quirks"){jQuery(".Controls ul .submenu").css("left","-75px")}sgf.notifyEventSubscribers(sgfEvents.DISPLAY_GADGET,f)}sgf.resetTitleStyles=function(d){var a=jQuery("#"+d+" h3");if(a!==null){for(var c=0;c<a.size();c++){var b=jQuery(a[c]);b.attr("title","");b.css("cursor","default")}}};function onLoadToolbarStateVertical(c){var e=jQuery("#sgfSlideBar");jQuery(document).ready(function(){e.unbind("click");e.click(function(g){toggleToolbarVertical(g)})});var b=parseInt(jQuery(window).width());e.css({position:"fixed",top:"","margin-top":"25px"});jQuery("#toolbarBody").css("height",calculateToolBarHeight());var f=parseInt(jQuery("#sciverse_toolbar").height()-7);f+="px";var d=jQuery("#"+c);if(vertToolbarWidth==null){vertToolbarWidth=VERTICAL_TOOLBAR_WIDTH+"px"}e.css("background-image","url("+gadgetIconPath+"/spriteImages.png)");if(sciverseObj.contextInfo.toolbarState=="Close"){b=b-toolbarImgWidth+"px";e.attr("title","Show right column");var a=jQuery(".sgfToolBarToggleImage");a.css({"border-right":"1px dashed #A5A5A5",height:jQuery("#colResults").height(),"background-position":"0px 0px",position:"fixed",right:"0px"});d.css("width",toolbarImgWidth);e.removeClass("sgfSideCollapse");e.addClass("sgfRefinementBarNoImage");e.css("background-position","-162px -218px");d.children("#sciverse_toolbar").css("display","none");sgftoggleState=1;a.css({"float":"right",overflow:"hidden"})}else{b=b-VERTICAL_TOOLBAR_WIDTH;b+="px";d.css("width",VERTICAL_TOOLBAR_WIDTH);d.children("#sciverse_toolbar").css("width",tbWidthwithoutImage);e.css("background-position","-101px -218px")}jQuery("#toolbarBody > .sgfInnerToolbar").css("min-height","208px")}function toggleToolbarVertical(o){var d;if(sciverseObj.contextInfo.toolbarState=="Close"){temptoolbarState=true}jQuery("#toolbarBody").css("height",calculateToolBarHeight());var a=jQuery(o.target).parents().find(".sgfVertToolbar").attr("id");var h=jQuery("#"+a);var c;var r="SubmitAction";var f="";var u=false;var l=jQuery("#sciverse_toolbar").css("display");var e=jQuery("#sgfSlideBar");var p=jQuery("#colResults");var i=jQuery(window).scrollTop();var b=jQuery(window).height();var t=0;e.addClass("sgfSideExpand");e.removeClass("sgfSideCollapse");e.css("background-image","url("+gadgetIconPath+"/spriteImages.png)");var q=parseInt(jQuery(window).width());var m=jQuery(".sgfToolBarToggleImage");if(l=="block"){h.css("width",toolbarImgWidth);m.css({"border-right":"1px dashed #A5A5A5",height:jQuery("#colResults").height(),position:"fixed",right:"0px"});e.css("background-position","-162px -218px");e.removeClass("sgfRefinementBarNoImage");h.children("#sciverse_toolbar").css("display","none");e.attr("title",sgf.labels.showRightColumn);var j=parseInt(jQuery(window).width())-parseInt(e.position().left);if(parseInt(e.position().left)>parseInt(jQuery(window).width())/2){j=j+parseInt(e.position().left)-29}else{j=j-18}j+="px";q=q-toolbarImgWidth;q+="px";sgftoggleState=1;if(i>p.offset().top){t=b/2;e.css({top:"",position:"fixed"})}else{if(i<p.offset().top){e.css({position:"fixed",top:"","margin-top":"25px"})}else{e.css({position:"fixed",top:"","margin-top":"25px"})}}var g=jQuery("#sgfSlideBar");g.css({position:"fixed"});c="Close";f="closeToolBar"}else{h.css("width",vertToolbarWidth);m.css("overflow","").css("border-right","none");e.removeClass("sgfRefinementBarNoImage");e.css("background-position","-101px -218px");h.children("#sciverse_toolbar").css({display:"block",width:tbWidthwithoutImage});e.css({"margin-left":"1px",top:"0px"});m.css("float","left");jQuery(o).css({"background-position":"-15px 0px"});e.attr("title",sgf.labels.hideRightColumn);sgftoggleState=0;q=q-VERTICAL_TOOLBAR_WIDTH;q+="px";e.css({position:"fixed",top:"","margin-top":"25px"});e.removeClass("sgfSideExpand");e.addClass("sgfSideCollapse");var s=jQuery("#toolbarBody").width();m.css({right:s});c="Open";f="openToolBar"}adjustColHeight();setTimeout("adjustHideimageHeight()",10000);if(jQuery("#toolbar_"+a).children().length==0&&f=="openToolBar"){sgf.renderGadgets(a,true,true,"togglezone")}var n=getGadgetOrder(a);saveToolBarState(c,f,r,u,a,n,showMoreApps)}function onLoadToolbarStateHorizontal(){jQuery(document).ready(function(){var e=jQuery("#toggleImgHorizon");e.unbind("click");e.click(function(f){toggleToolbarHorizontal(f)})});var b=jQuery("#arrowImg");var d=jQuery("#arrowImg1");var a=jQuery("#FooterText");var c=jQuery("#sciverse_toolbar");if(sciverseObj.contextInfo.toolbarState=="Close"){b.attr("src",gadgetIconPath+"/showDownArrow.gif");d.attr("src",gadgetIconPath+"/showDownArrow.gif");a.text("Show Applications")}else{b.attr("src",gadgetIconPath+"/hideUpArrow.gif");d.attr("src",gadgetIconPath+"/hideUpArrow.gif");a.text("Hide Applications");c.css("display","block")}}function toggleToolbarHorizontal(b){if(sciverseObj.contextInfo.toolbarState=="Close"){temptoolbarState=true}var l;var a="SubmitAction";var i="";var h=false;var e=jQuery(b.target).parent().attr("id");if(e=="toggleImgHorizon"){e=jQuery("#"+e).parent().attr("id")}var g=jQuery("#sciverse_toolbar");var j=jQuery("#arrowImg");var f=jQuery("#arrowImg1");var d=jQuery("#FooterText");if(g.css("display")=="block"){g.slideToggle("normal");j.attr("src",gadgetIconPath+"/showDownArrow.gif");f.attr("src",gadgetIconPath+"/showDownArrow.gif");d.text("Show Applications");l="Close";i="closeToolBar"}else{g.slideToggle("normal");j.attr("src",gadgetIconPath+"/hideUpArrow.gif");f.attr("src",gadgetIconPath+"/hideUpArrow.gif");d.text("Hide Applications");l="Open";i="openToolBar"}g_toolbarState=l;if(jQuery("#toolbar_"+e).children().length==0&&i=="openToolBar"){sgf.renderGadgets(e,true,true,"togglezone")}var c=getGadgetOrder(e);saveToolBarState(l,i,a,h,e,c,showMoreApps)}function saveToolBarState(i,f,b,e,h,c,d){var g="originPage="+sciverseObj.contextInfo.pageType+"&toolbarOpen="+i+"&eventName="+f+"&pageName="+sciverseObj.contextInfo.pageType;g+="&location="+h+"&keyEventType="+b;g+="&zone="+h+"&isKeyEventURLAvailble="+isKeyEventURLExists;g+="&gadgetOrder="+c+"&isViewMore="+d;var a=new Array();a.push(sciverseObj.smapiVars.gsUrl);a.push("/rest/locationstate/location/gs/");a.push(h);a.push("?clientToken=");a.push(sciverseObj.contextInfo.secureAuthtoken);a.push("&sessionId=");a.push(sciverseObj.contextInfo.sessionId);jQuery.ajax({type:"POST",url:a.join(""),async:true,data:g})}ajaxKeyEventLog=function(l,e,g,b,m,d,h,o,a,n){if((o=="open"||o=="close")&&e=="displayGadget"){return}for(var f=0;f<=arguments.length;f++){if(arguments[f]==null){arguments[f]=""}}if(n=="undefined"||typeof(n)=="undefined"){n=""}var j="moduleName="+l+"&location="+n+"&eventName="+e+"&gadgetId="+g+"&pageName="+sciverseObj.contextInfo.pageType+"&zone="+n+"&failed="+h+"&keyEventType="+d+"&partner="+a+"&gadgetState="+o+"&targetURL="+m;var c=new Array();c.push(sciverseObj.smapiVars.gsUrl);c.push("/rest/usagekeyevent/create");c.push("?clientToken=");c.push(sciverseObj.contextInfo.secureAuthtoken);c.push("&sessionId=");c.push(sciverseObj.contextInfo.sessionId);jQuery.ajax({type:"POST",url:c.join(""),data:j})};sgf.isKeyEventURLAvailable=function(){if(typeof(sciverseObj.smapiVars.keyEventURL)!=="undefined"&&sciverseObj.smapiVars.keyEventURL!=null){isKeyEventURLExists=true}else{isKeyEventURLExists=false}};function isGadgetRemoveURLAvailable(){if(sciverseObj.smapiVars.gsUrl==null){isGadgetRemoveURLExists=false}else{isGadgetRemoveURLExists=true}}sgf.setGadgetIHSURL=function(){gadgetIconPath=sciverseObj.smapiVars.gsUrl+"/gadgets/"+releaseNumber+"/images";gadgetJSPath=sciverseObj.smapiVars.gsUrl+"/gadgets/"+releaseNumber+"/js"};sgf.isUserEntitled=function(){if(sciverseObj.gadgetInfos.length==0||sciverseObj.gadgetInfos==""){isUserEntitledtoGadgets=false}else{isUserEntitledtoGadgets=true}};function getGadgetOrder(a){var c;var n=new Array();if(jQuery("#"+a).hasClass("sgfShowMyApps")){c="toolbar_"+a}else{c=a}var e=new Array();var f=jQuery("#"+c).children();if(f!=null&&f!=undefined&&f.length>0){for(var j=0;j<f.length;j++){e.push(f[j].id)}}var l=a.length+1;for(var g=0;g<e.length;g++){if(e[g].length>1){n.push(e[g].substring(l))}else{n.push("")}}var b=new Array();b=sciverseObj.locationsOnPage[a].gadgets;var d=new Array();d=sgf.calculateArrayDifference(b,n);var h=gadgets.json.stringify(n).substring(0,gadgets.json.stringify(n).length-1);if(d!="[]"||d!=null){for(var m=0;m<=d.length-1;m++){h+=",";h+='"';h+=d[m];h+='"'}}h+="]";return h}sgf.applySortable=function(b){var a=(jQuery("#"+b).hasClass("sgfShowMyApps"))?"toolbar_"+b:b;jQuery("#"+a).sortable({handle:"h3",start:function(d,e){var f=jQuery(".ui-sortable-placeholder");if(typeof(placeholderGadgegators)!="undefined"&&placeholderGadgegators!=null&&jQuery("#"+a).hasClass("sgfIsGadgeGator")){f.css(placeholderGadgegators)}else{f.css({border:"1px solid #FED22F ",margin:"2px",visibility:"visible",background:"#FED22F"})}var c=jQuery('<div style="background:#000;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);opacity:0;">&nbsp;</div>');jQuery("body").prepend(c[0]);c[0].id="temp_OverLayDiv";c.css({position:"absolute",cursor:"move"});c.css({top:0,left:0});c.css("z-index","1009");c.height(2*(jQuery(document).height()));c.width("100%")},stop:function(g,i){jQuery("#temp_OverLayDiv").remove();var h=jQuery("#"+a).sortable("toArray");for(var d=0;d<visibleAppCount;d++){var e=jQuery("#"+h[d]);if(e.hasClass("tempExtendedAreaApp")){e.removeClass("tempExtendedAreaApp")}}if(h.length>visibleAppCount){for(var j=visibleAppCount;j<h.length;j++){var f=jQuery("#"+h[j]);if(!f.hasClass("tempExtendedAreaApp")){f.addClass("tempExtendedAreaApp")}}}var c=getGadgetOrder(b);saveToolBarState(g_toolbarState,"gadgetReorder","SubmitActionUsage",false,b,c,showMoreApps)}})};function showMore(){showMoreApps="Y";var e=jQuery("#showMoreApps").parents(".sgfShowMyApps").attr("id");var d=jQuery(".ExtendedAreaApp");if(d.length>0){for(var c=0;c<d.length;c++){var b=jQuery(d[c]);b.removeClass("ExtendedAreaApp");b.addClass("tempExtendedAreaApp")}}else{sgf.renderGadgets(e,true,true,"showMoreLess")}jQuery("#showMoreApps").hide();jQuery("#showLessApps").show();if(toolbarOrientation=="vertical"){var f=parseInt(jQuery("#sciverse_toolbar").height()-7);jQuery("#toggleImg").css("height",f+"px")}if(browser==="FF"){sgf.resetTitleStyles(e)}else{sgf.applySortable(e)}var a=getGadgetOrder(e);saveToolBarState(g_toolbarState,"showMoreApps","SubmitActionUsage",false,e,a,showMoreApps)}function showLess(){showMoreApps="N";var d=jQuery("#showLessApps").parents(".sgfShowMyApps").attr("id");var c=jQuery(".tempExtendedAreaApp");for(var b=0;b<c.length;b++){jQuery(c[b]).removeClass("tempExtendedAreaApp");jQuery(c[b]).addClass("ExtendedAreaApp")}jQuery("#showLessApps").hide();jQuery("#showMoreApps").show();if(toolbarOrientation=="vertical"){var e=parseInt(jQuery("#sciverse_toolbar").height()-7)}var a=getGadgetOrder(d);saveToolBarState(g_toolbarState,"showLessApps","SubmitActionUsage",false,d,a,showMoreApps)}function getGadgetOrderHomePage(d){var j=jQuery("#column0").sortable("toArray");var f=jQuery("#column1").sortable("toArray");var b=jQuery("#column2").sortable("toArray");var g=new Array();var a=Math.max(j.length,f.length,b.length);for(var l=0;l<=a-1;l++){if(j[l]){g.push(j[l])}else{g.push("")}if(f[l]){g.push(f[l])}else{g.push("")}if(b[l]){g.push(b[l])}else{g.push("")}}var c=new Array();var h=d.length+1;for(var e=0;e<g.length;e++){if(g[e].length>1){c.push(g[e].substring(h))}else{c.push("")}}return gadgets.json.stringify(c)}sgf.calculateArrayDifference=function(e,d){var c=new Array();for(var b=0;b<d.length;b++){c.push(parseInt(d[b]))}var a=new Array();for(var b=0;b<e.length;b++){if(jQuery.inArray(parseInt(e[b]),c)==-1){a.push(e[b])}}return a};function adjustHideimageHeight(){if(toolbarOrientation!="vertical"){return}var a=parseInt(jQuery("#sciverse_toolbar").height(),10)-7;a+="px"}resetHomePageColumnHeights=function(){jQuery("#column0").css("height","auto");jQuery("#column1").css("height","auto");jQuery("#column2").css("height","auto")};adjustHomePageColumnHeights=function(){var a=jQuery("#column0").height();var b=jQuery("#column1").height();var c=jQuery("#column2").height();var d=Math.max(a,b,c);jQuery("#column0").height(d);jQuery("#column1").height(d);jQuery("#column2").height(d);jQuery("#column0").parents(".toolbarBodyFull").height(d+30)};function adjustColHeight(){resetHomePageColumnHeights();adjustHomePageColumnHeights();if(jQuery("#toolbarBody > .sgfInnerToolbar").children().length>0){jQuery("#toolbarBody").css("height",calculateToolBarHeight())}else{setTimeout('jQuery("#toolbarBody").css("height",calculateToolBarHeight())',22000)}}jQuery(document).ready(function(){jQuery(window).trigger("hashchange");jQuery(document).on("mouseover mouseout",".sgfHiddenChrome",function(a){if(a.type=="mouseover"){var b=jQuery(this).find(".showTitleBarOnHover");if(b.hasClass("sgfOpen")){b.addClass("ActiveGadget")}else{b.addClass("InactiveGadget")}jQuery(this).find(".showBorderOnHover").css({"border-style":"solid","border-top":""})}else{var b=jQuery(this).find(".showTitleBarOnHover");if(b.hasClass("sgfClose")){b.removeClass("InActiveGadget")}else{b.removeClass("ActiveGadget")}jQuery(this).find(".showBorderOnHover").css({"border-style":"none","border-top":""})}});jQuery(document).on("mouseover mouseout",".containerApplOver",function(a){if(a.type=="mouseover"){if(isScopusIE7){var b=jQuery(".sgfSciverseHoriToolBar ");b.css({position:"relative","z-index":"10"})}if(jQuery(this).find(".Controls_close").css("display")=="none"){jQuery(this).find(".Controls").show()}}else{jQuery(this).find(".Controls").hide()}})});jQuery(window).bind("hashchange",function(b){var a=jQuery.param.fragment();removeCanvas(a)});function removeCanvas(b){var a;if(b.indexOf("dialogId")!=-1){jQuery("#canvas").dialog("open")}else{jQuery("#canvas").remove();jQuery("body").css("overflow","auto")}}function sgfToggleToolBarOver(){}function sgfToggleToolBarOut(){if(sgftoggleState==1){jQuery("#sgfSlideBar").css("background-position","-162px -218px")}}function isSDArticlesPage(){var a=false;if(sciverseObj.contextInfo.platform=="SD"&&sciverseObj.contextInfo.pageType=="article"){a=true}return a}function isSDResultsPage(){var a=false;if(sciverseObj.contextInfo.platform=="SD"&&sciverseObj.contextInfo.pageType=="resultsList"){a=true}return a}sgf.setToolBarWidth=function(){if(sciverseObj.contextInfo.platform=="SC"&&(sciverseObj.contextInfo.pageType=="AuthorProfile"||sciverseObj.contextInfo.pageType=="recordpage")){var a=jQuery("#toolbarBody > .sgfInnerToolbar");a.css({margin:"0",width:"100%"})}};sgf.processMmcGadgets=function(h){var l=jQuery("#"+h+" dl.ecomponent");if(l!=null&&l!=undefined&&l.length>0){for(var f=0;f<l.length;f++){var n=l[f].id;var c=jQuery("#"+n+" dd.ecomponent");if(c!=null&&c!=undefined&&c.length>0){for(var e=0;e<c.length;e++){var p=jQuery(c[e]).attr("data-ext");var b=jQuery(c[e]).attr("data-eid");var a=c[e].id;if(sciverseObj.mmcGadgets!=undefined&&sciverseObj.mmcGadgets!=null){if(sciverseObj.mmcGadgets[p]!=undefined&&sciverseObj.mmcGadgets[p]!=null){var d=sciverseObj.mmcGadgets[p][0];if(d!=undefined&&d!=null){if(sciverseObj.gadgetInfos!=undefined&&sciverseObj.gadgetInfos!=null){var g=sciverseObj.gadgetInfos[d];if(g!=undefined&&g!=null){var m=g.mmcTypes[p]["url"];m="";var o=g.mmcTypes[p]["altText"];if(typeof SDM!=="undefined"&&typeof SDM.svapi!=="undefined"&&typeof SDM.svapi.addMenuItem==="function"){SDM.svapi.addMenuItem(n,a,m,o,sgf.invokeMmcGadget);sgf.invokeMmcGadget(n,a)}}}}}}}}}}};sgf.invokeMmcGadget=function(i,c){var d=jQuery("#"+i+" > #"+c);if(d!=undefined&&d!=null){var l=d.attr("data-ext");var b=d.attr("data-eid");var f=sciverseObj.mmcGadgets[l][0];if(f!=undefined&&f!=null){var h="";h=sciverseObj.gadgetInfos[f];d.children().hide();shindig.container.layoutManager=new shindig.FloatLeftLayoutManager();shindig.container.layoutManager.layoutRootId_=i+" > #"+c;var e=shindig.container.createGadget({specUrl:h.url,title:h.gadgetName,userPrefs:h.userPreferences,requiresPubSub2:h.requiresPubSub2});e.sciverseId_=h.gadgetId;e.isMmcRendering=true;e.open="Y";e.includeTitle=false;e.isExtendedAreaApp="N";e.includeBorder=false;e.location=i+"_"+c;e.isCanvasViewAvailable="N";e.isHoverViewAvailable="N";e.isStartMeInvisible=false;e.removable=h.removable;e.iconURL=(h.gadgetIcon==null||h.gadgetIcon=="")?gadgetIconPath+"/netbase.gif":h.gadgetIcon;e.hasUserPrefs=h.hasUserPrefs;shindig.container.addGadget(e);var j={mmcType:l,eid:b};e.prepareGadgetForView("mmc",d,j)}var a=sgf.constructKeyEventStrForMMC(l,"inline",h.gadgetId,"requestmmfile","a")}};sgf.constructKeyEventStrForMMC=function(d,e,b,f,a){var c="MMCType="+d+"&playerType="+e+"&gadgetId="+b+"&eventName="+f+"&location="+a;if(sciverseObj.contextInfo.issn!=undefined&&sciverseObj.contextInfo.issn!=null&&sciverseObj.contextInfo.issn!=""){c+="&issn=";c+=sciverseObj.contextInfo.issn}if(sciverseObj.contextInfo.isbn!=undefined&&sciverseObj.contextInfo.isbn!=null&&sciverseObj.contextInfo.isbn!=""){c+="&isbn=";c+=sciverseObj.contextInfo.isbn}if(sciverseObj.contextInfo.pii!=undefined&&sciverseObj.contextInfo.pii!=null&&sciverseObj.contextInfo.pii!=""){c+="&pii=";c+=sciverseObj.contextInfo.pii}if(sciverseObj.contextInfo.eid!=undefined&&sciverseObj.contextInfo.eid!=null&&sciverseObj.contextInfo.eid!=""){c+="&eid=";c+=sciverseObj.contextInfo.eid}if(sciverseObj.contextInfo.fmt!=undefined&&sciverseObj.contextInfo.fmt!=null&&sciverseObj.contextInfo.fmt!=""){c+="&fmt=";c+=sciverseObj.contextInfo.fmt}return c};sgf.ajaxKeyEventNonGadgetLog=function(a){var b=new Array();b.push(sciverseObj.smapiVars.gsUrl);b.push("/rest/usagekeyevent/create");b.push("?clientToken=");b.push(sciverseObj.contextInfo.secureAuthtoken);b.push("&sessionId=");b.push(sciverseObj.contextInfo.sessionId);jQuery.ajax({type:"POST",url:b.join(""),data:a})};sgf.processInterRefs=function(a){var d=jQuery("#"+a+" span.interref");if(d!=null&&d!=undefined&&d.length>0){for(var e=0;e<d.length;e++){var g=jQuery(d[e]);var h=g.attr("data-locatorType");var c=sciverseObj.interRefGadgets[h];if(c!=undefined&&c!=null&&c.length>0){var b=jQuery(g).text();g.unbind("click");g.removeAttr("onclick");g.bind("click",{interRefType:h,displayTerm:b},function(i){sgf.notifyInterRefGadgets(i)});if(!g.hasClass("svDoNotLink")){g.addClass("svDoNotLink")}var f=jQuery(g).find("a");if(f!=undefined&&f!=null&&f.length>0){f.removeAttr("onclick");f.click(function(i){i.preventDefault()})}}}}};sgf.notifyInterRefGadgets=function(h){var m=getMouseClickCoordinates(h);var e=listeners.interRef;if(e!=undefined&&e!=null){for(var d=0,g=e.length;d<g;d++){var a=shindig.container.gadgetService.getGadgetIdFromModuleId(e[d].frame);if(a!=undefined&&a!=null){var b=shindig.container.getGadget(a);if(b!=undefined&&b!=null){var f=sciverseObj.gadgetInfos[b.sciverseId_];if(f!=undefined&&f!=null){var l=f.interRefs;if(l!=undefined&&l!=null){for(var c=0;c<l.length;c++){if(h.data.interRefType==l[c]){gadgets.rpc.call(e[d].frame,e[d].callback,null,h.data.interRefType,h.data.displayTerm,m.x,m.y);break}}}}}}}}};function applysortableForHomePage(a){jQuery("#column0, #column1, #column2").sortable({placeholder:"ui-state-highlight",handle:"h3",connectWith:".connectedSortable",start:function(c,d){var b=jQuery('<div style="background:#000;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);opacity:0;">&nbsp;</div>');jQuery("body").prepend(b[0]);b[0].id="temp_OverLayDiv";b.css({position:"absolute",cursor:"move"});b.css({top:0,left:0});b.css("z-index","1009");b.height(2*(jQuery(document).height()));b.width("100%")},stop:function(d,e){jQuery("#temp_OverLayDiv").remove();var c=(checkCompliance()=="Quirks")?true:false;if(c){jQuery(".Controls").css("position","")}else{jQuery(".Controls").css("position","relative")}var b=getGadgetOrderHomePage(a);saveToolBarState(g_toolbarState,"gadgetReorder","SubmitActionUsage",false,a,b,showMoreApps)},update:function(b,c){resetHomePageColumnHeights();adjustHomePageColumnHeights()}}).disableSelection()}function calculateToolBarHeight(){var a=jQuery("#colResults").height();if(parseInt(jQuery("#toolbarBody > .sgfInnerToolbar").height())>parseInt(jQuery("#colResults").height())){a=jQuery("#sgfInnerToolbar").height()}return a}sgf.subscribeForEvents=function(a,b){if(eventSubscriptionList[a]!=undefined&&eventSubscribtionList[a]!=null){var c=eventSubscribtionList[a];c.push(b);eventSubscriptionList[a]=c}else{var c=[];c.push(b);eventSubscriptionList[a]=c}};sgf.saveEventData=function(a,e,i,d,h){if(d!=undefined&&d!=null){var g="profile";if(h!=undefined&&h!=null&&h!=""){g=h}var c=sciverseObj.gadgetInfos[a]["entTyp"];var f=sciverseObj.gadgetInfos[a]["privFlag"];if(d[e]!=undefined&&d[e]!=null){var b=d[e];b.push('{"gId":"'+a+'","privFlag":"'+f+'","entType":"'+c+'","locationId":"'+i+'","view":"'+g+'"}');d[e]=b}else{var b=[];b.push('{"gId":"'+a+'","privFlag":"'+f+'","entType":"'+c+'","locationId":"'+i+'","view":"'+g+'"}');d[e]=b}}};sgf.notifyEventSubscribers=function(b,e){if(e!=undefined&&e!=null&&e[b]){var c=[];if(eventSubscriptionList[b]){c=eventSubscriptionList[b];for(var d=0;d<c.length;d++){var a=gadgets.json.parse("["+e[b].join(",")+"]");c[d](a)}}}};var sgfEvents={DISPLAY_GADGET:"displayGadget",INVOKE_WORKSPACE_VIEW:"invokeWorkSpaceView"};
/*!
* jQuery outside events - v1.1 - 3/16/2010
* http://benalman.com/projects/jquery-outside-events-plugin/
*
* Copyright (c) 2010 "Cowboy" Ben Alman
* Dual licensed under the MIT and GPL licenses.
* http://benalman.com/about/license/
*/
(function($,c,b){$.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(d){a(d)});a("focusin","focus"+b);a("focusout","blur"+b);$.addOutsideEvent=a;function a(g,e){e=e||g+b;var d=$(),h=g+"."+e+"-special-event";$.event.special[e]={setup:function(){d=d.add(this);if(d.length===1){$(c).bind(h,f)}},teardown:function(){d=d.not(this);if(d.length===0){$(c).unbind(h)}},add:function(i){var j=i.handler;i.handler=function(m,l){m.target=l;j.apply(this,arguments)}}};function f(i){$(d).each(function(){var j=$(this);if(this!==i.target&&!j.has(i.target).length){j.triggerHandler(e,[i.target])}})}}})(jQuery,document,"outside");(function(a){a.fn.ellipsis=function(b){var c=document.documentElement.style;if(!("textOverflow" in c||"OTextOverflow" in c)){return this.each(function(){var f=a(this);if(f.css("overflow")=="hidden"){var i=f.html();var d=f.width();var e=a(this.cloneNode(true)).hide().css({position:"absolute",width:"auto",overflow:"visible","max-width":"inherit"});f.after(e);var h=i;while(h.length>0&&e.width()>f.width()){h=h.substr(0,h.length-1);e.html(h+"...")}f.html(e.html());e.remove();if(b==true){var g=f.width();setInterval(function(){if(f.width()!=g){g=f.width();f.html(i);f.ellipsis()}},200)}}})}else{return this}}})(jQuery);(function(I,X){var aj,ad=Array.prototype.slice,T=decodeURIComponent,aq=I.param,ah,ao,ae,K,ap=I.bbq=I.bbq||{},V,L,ag,am=I.event.special,an="hashchange",Z="querystring",R="fragment",J="elemUrlAttr",af="href",N="src",ab=/^.*\?|#.*$/g,Q,M,ak,ai,W,S={};function P(a){return typeof a==="string"}function U(a){var b=ad.call(arguments,1);return function(){return a.apply(this,b.concat(ad.call(arguments)))}}function ac(a){return a.replace(M,"$2")}function Y(a){return a.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function al(h,c,j,g,i){var a,d,e,b,f;if(g!==aj){e=j.match(h?M:/^([^#?]*)\??([^#]*)(#?.*)/);f=e[3]||"";if(i===2&&P(g)){d=g.replace(h?Q:ab,"")}else{b=ae(e[2]);g=P(g)?ae[h?R:Z](g):g;d=i===2?g:i===1?I.extend({},g,b):I.extend({},b,g);d=ah(d);if(h){d=d.replace(ak,T)}}a=e[1]+(h?W:d||!e[1]?"?":"")+d+f}else{a=c(j!==aj?j:location.href)}return a}aq[Z]=U(al,0,Y);aq[R]=ao=U(al,1,ac);aq.sorted=ah=function(c,b){var d=[],a={};I.each(aq(c,b).split("&"),function(e,h){var f=h.replace(/(?:%5B|=).*$/,""),g=a[f];if(!g){g=a[f]=[];d.push(f)}g.push(h)});return I.map(d.sort(),function(e){return a[e]}).join("&")};ao.noEscape=function(a){a=a||"";var b=I.map(a.split(""),encodeURIComponent);ak=new RegExp(b.join("|"),"g")};ao.noEscape(",/");ao.ajaxCrawlable=function(a){if(a!==aj){if(a){Q=/^.*(?:#!|#)/;M=/^([^#]*)(?:#!|#)?(.*)$/;W="#!"}else{Q=/^.*#/;M=/^([^#]*)#?(.*)$/;W="#"}ai=!!a}return ai};ao.ajaxCrawlable(0);I.deparam=ae=function(a,d){var b={},c={"true":!0,"false":!1,"null":null};I.each(a.replace(/\+/g," ").split("&"),function(l,f){var m=f.split("="),g=T(m[0]),n,h=b,j=0,e=g.split("]["),i=e.length-1;if(/\[/.test(e[0])&&/\]$/.test(e[i])){e[i]=e[i].replace(/\]$/,"");e=e.shift().split("[").concat(e);i=e.length-1}else{i=0}if(m.length===2){n=T(m[1]);if(d){n=n&&!isNaN(n)?+n:n==="undefined"?aj:c[n]!==aj?c[n]:n}if(i){for(;j<=i;j++){g=e[j]===""?h.length:e[j];h=h[g]=j<i?h[g]||(e[j+1]&&isNaN(e[j+1])?{}:[]):n}}else{if(I.isArray(b[g])){b[g].push(n)}else{if(b[g]!==aj){b[g]=[b[g],n]}else{b[g]=n}}}}else{if(g){b[g]=d?aj:""}}});return b};function aa(a,c,b){if(c===aj||typeof c==="boolean"){b=c;c=aq[a?R:Z]()}else{c=P(c)?c.replace(a?Q:ab,""):c}return ae(c,b)}ae[Z]=U(aa,0);ae[R]=K=U(aa,1);I[J]||(I[J]=function(a){return I.extend(S,a)})({a:af,base:af,iframe:N,img:N,input:N,form:"action",link:af,script:N});ag=I[J];function O(a,c,b,d){if(!P(b)&&typeof b!=="object"){d=b;b=c;c=aj}return this.each(function(){var e=I(this),g=c||ag()[(this.nodeName||"").toLowerCase()]||"",f=g&&e.attr(g)||"";e.attr(g,aq[a](f,b,d))})}I.fn[Z]=U(O,Z);I.fn[R]=U(O,R);ap.pushState=V=function(a,d){if(P(a)&&/^#/.test(a)&&d===aj){d=2}var b=a!==aj,c=ao(location.href,b?a:{},b?d:2);location.href=c};ap.getState=L=function(b,a){return b===aj||typeof b==="boolean"?K(b):K(a)[b]};ap.removeState=function(b){var a={};if(b!==aj){a=L();I.each(I.isArray(b)?b:arguments,function(c,d){delete a[d]})}V(a,2)};am[an]=I.extend(am[an],{add:function(c){var a;function b(e){var d=e[R]=ao();e.getState=function(g,f){return g===aj||typeof g==="boolean"?ae(d,g):ae(d,f)[g]};a.apply(this,arguments)}if(I.isFunction(c)){a=c;return b}else{a=c.handler;c.handler=b}}})})(jQuery,this);(function(j,p,s){var r="hashchange",m=document,o,n=j.event.special,l=m.documentMode,q="on"+r in p&&(l===s||l>7);function t(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}j.fn[r]=function(a){return a?this.bind(r,a):this.trigger(r)};j.fn[r].delay=50;n[r]=j.extend(n[r],{setup:function(){if(q){return false}j(o.start)},teardown:function(){if(q){return false}j(o.stop)}});o=(function(){var d={},e,a=t(),c=function(h){return h},b=c,f=c;d.start=function(){e||g()};d.stop=function(){e&&clearTimeout(e);e=s};function g(){var h=t(),i=f(a);if(h!==a){b(a=h,i);j(p).trigger(r)}else{if(i!==a){location.href=location.href.replace(/#.*/,"")+i}}e=setTimeout(g,j.fn[r].delay)}j.browser.msie&&!q&&(function(){var i,h;d.start=function(){if(!i){h=j.fn[r].src;h=h&&h+t();i=j('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){h||b(t());g()}).attr("src",h||"javascript:0").insertAfter("body")[0].contentWindow;m.onpropertychange=function(){try{if(event.propertyName==="title"){i.document.title=m.title}}catch(u){}}}};d.stop=c;f=function(){return t(i.location.href)};b=function(w,z){var x=i.document,y=j.fn[r].domain;if(w!==z){x.title=m.title;x.open();y&&x.write('<script>document.domain="'+y+'"<\/script>');x.close();i.location.hash=w}}})();return d})()})(jQuery,this);var channels={};var listeners={};var verticalScroll=0;shindig.SciverseContainer=function(){shindig.IfrContainer.call(this);this.view_="profile"};shindig.SciverseContainer.inherits(shindig.IfrContainer);shindig.container=new shindig.SciverseContainer();var terms;shindig.SciverseGadget=function(a){shindig.BaseIfrGadget.call(this,a);this.setServerBase(sciverseObj.smapiVars.serverBaseURL+"/")};shindig.SciverseGadget.inherits(shindig.BaseIfrGadget);shindig.IfrContainer.prototype.gadgetClass=shindig.SciverseGadget;shindig.SciverseGadget.prototype.queryIfrGadgetType_=function(){var c=this;var b=c.requiresPubSub2?shindig.OAAIfrGadget:shindig.IfrGadget;for(var a in b){if(b.hasOwnProperty(a)){this[a]=b[a]}}};shindig.FloatLeftLayoutManager.prototype.getGadgetChrome=shindig.FloatLeftLayoutManager.prototype.getGadgetChrome=function(d,c){var b=jQuery("#"+this.layoutRootId_);if(b){var a=document.createElement("div");a.id=d.location+"_"+d.sciverseId_;a.className="containerApplOver";if(d.isMmcRendering){}else{if(d.isExtendedAreaApp&&!d.isStartMeInvisible){a.className="containerApplOver tempExtendedAreaApp "}else{if(d.isExtendedAreaApp&&d.isStartMeInvisible){a.className="containerApplOver tempExtendedAreaApp invisible"}else{if(!d.isExtendedAreaApp&&d.isStartMeInvisible){a.className="containerApplOver invisible"}}}}if(d.isOnhoverChromeRequired){jQuery(a).addClass("sgfHiddenChrome")}if(d.prependToLocation){b.prepend(a)}else{b.append(a)}return a}else{return null}};shindig.FloatLeftLayoutManager.prototype.getGadgetDebugChrome=function(d,b){var a=document.getElementById(this.layoutRootId_);if(a){var c=document.createElement("textarea");c.id=b+"_debug_"+d;c.style.width="97%";c.style.textAlign="center";c.readonly="readonly";a.appendChild(c);return c}else{return null}};shindig.IfrContainer.prototype.renderGadget=function(d,b,c,a){if(b==="canvas"){sgf.startTimer("canvas","canvas",d.id);d.renderCanvas(c,d)}else{if(b==="sciverseResultsView"){sgf.startTimer(d.sciverseId_,d.location,d.id);d.renderResultsView(a,c)}else{if(b==="sciverseColumnView"){sgf.startTimer(d.sciverseId_,d.location,d.id);d.renderColumnView(a,c)}else{if(b==="hover"){sgf.startTimer(d.sciverseId_,d.location,d.id);d.renderHooverView(a,c)}else{if(b==="mmc"||b==="workspace"){sgf.startTimer(d.sciverseId_,d.location,d.id);a=this.layoutManager.getGadgetChrome(d);d.renderMmcView(a,c)}else{var a=this.layoutManager.getGadgetChrome(d);log(d.sciverseId_,d.location,"chrome created");sgf.startTimer(d.sciverseId_,d.location,d.id);log(d.sciverseId_,d.location,"timer created");d.render(a);log(d.sciverseId_,d.location,"gadget rendered");log(d.sciverseId_,d.location,gadgets.json.stringify(sciverseObj.contextInfo))}}}}}};var sgf=sgf||{};sgf.startTimer=function(b,a,c){if(typeof(timers_)=="undefined"||timers_==null){timers_=new Array()}timers_[a+b]=setTimeout("sgf.timeout('"+b+"', '"+a+"', '"+c+"')",sciverseObj.smapiVars.gadgetLoadTimeout)};sgf.timeout=function(c,b,d){if(toolbarOrientation=="vertical"){var e=parseInt(jQuery("#sciverse_toolbar").height()-7);jQuery("#toggleImg").css("height",e+"px")}jQuery("#Controls_"+d).css("display","none");jQuery("#Close_"+d).css("display","");var a=jQuery("#maincontremote_iframe_"+d);a.css("height","125px");a.html("Gadget timed out while loading");log(c,b,"Gadget timedout while loading.")};sgf.killTimer=function(b,a){clearTimeout(timers_[a+b]);log(b,a,"Timer Killed");if(!sciverseObj.contextInfo.toolbarState){var c=parseInt(jQuery("#sciverse_toolbar").height()-7)}};shindig.SciverseGadget.prototype.render=function(a){if(a){var b=this;this.getContent(function(c){a.innerHTML=c;if(b.requiresPubSub2===true){b.oaaIframeId=b.finishRender()}})}};shindig.IfrGadget.getMainContent=function(e){var h=sciverseObj.smapiVars.gadgetDetailPage+"/"+this.sciverseId_;var m=this.getIframeId();var j="";var l=this.location;var g=false;var f;var i;if(typeof(this.height)!="undefined"&&this.height!=null){i=this.height}else{i=""}var c="";if(this.isOnhoverChromeRequired){c="showMainContentOnHover"}if(MSIE7Flag){if(toolbarWidth==null||toolbarWidth==""){f="100%"}else{if(toolbarOrientation.toLowerCase()=="vertical"){f=parseInt(tbWidthwithoutImage,10)-15;f+="px"}else{f=parseInt(toolbarWidth,10)-15;f+="px"}}}else{if(toolbarWidth==null||toolbarWidth==""){f="100%"}else{f="99.5%"}}var n="";var a="";var d="";if(this.isOnhoverChromeRequired){d="showBorderOnHover"}if((typeof(this.includeBorder)!="undefined"&&!this.includeBorder)||this.isOnhoverChromeRequired){n="none"}else{n="solid"}if(this.includeBorder&&!this.includeTitle){a="1px solid #FEC76D"}if(this.open==="N"){var b="none"}else{b=""}j+='<div id="maincont'+m+'" style="display:'+b+";border-style:"+n+" ;border-top:"+a+'" class="containerAppDetails '+d+'">';j+='<iframe id="'+m+'"onload="sgf.killTimer(\''+this.sciverseId_+"', '"+this.location+'\');" name="'+m+'"  src="'+(b=="none"?"":this.getIframeUrlWithPreferredView())+'" style=" align: left;text-align: left;"" frameborder="no"  scrolling="auto" height="'+i+'" width="'+f+'"></iframe>';j+="</div>";gadgets.rpc.setRelayUrl(m,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(m,this.rpcToken);log(this.sciverseId_,"got frame content");e(j)};shindig.SciverseGadget.prototype.getTitleBarContent=function(h){if(this.includeTitle==false){h("");return}var g;if(this.title){g=this.title}else{g="title"}var l="";var a=""+gadgetIconPath+"/gsframeworksprite.png";var p=decodeURIComponent(sgf.labels.closeApp);var n;var i;var e;var r;var m;var d="";var f="";var j="";var c="menu";var q="sprite-close";if(this.open==="N"){p=decodeURIComponent(sgf.labels.openApp);n=true;appheaderClass="InactiveGadget";m="elsevierTimeL";j="sgfClose";c="closedMenu";q="sprite-open"}else{n=false;appheaderClass="ActiveGadget";m="elsevierTimeLOver";j="sgfOpen"}if(this.isOnhoverChromeRequired){d="showTitleBarOnHover";appheaderClass=""}if(jQuery("#"+this.location).hasClass("sgfIsGadgeGator")){var o="background: url(/static/images/tmp/dottedLine.gif) repeat-x 0 16px;";var b="display:inline-block;";if(MSIE7Flag===true){o="";b=""}l='<div class="curveBoxleftNormal" style="background-color:#EBEBEB; padding:0; margin-right: 8px; color:#000000;font-weight:bold; font-size: 14px;'+o+'">';l+='<span class="truncateTitle" style="background-color: #EBEBEB;'+b+' "><h3 id="GadgetName';l+=this.id;l+='" class="';l+=m;l+='" style="display:inline;font-size:1.1em;text-transform: capitalize; width:auto; color:#000000;padding-right:4px;">';l+=g;l+="</h3></span>";l+='<a href="javascript:void(0);" onclick="shindig.container.getGadget('+this.id+').handleToggle(this);"><div id="toggleBtn_'+this.id+'"  class="'+q+' gadgegatorToggleBtn" title="'+p+'"style="background-image: url(\''+gadgetIconPath+"/gsframeworksprite.png');\"></div></a>";l+="</div>"}else{l+='<div id="footer'+this.cssClassTitleBar+"-"+this.id+'" class="curveBoxleftNormal '+appheaderClass+" "+d+" "+j+'" >';l+='<img src="'+this.iconURL+'"  border="none" class="headingGadgetIcon '+f+'" title="'+this.title+'">';l+='<h3 title="'+decodeURIComponent(sgf.labels.moveApp)+'" id="GadgetName'+this.id+'" title="'+this.title+'" class="'+m+' truncateTitle">'+g+'</h3><div id="Controls_'+this.id+'"class="Controls menuControlParent" align="right"><ul  class="'+c+'">';l+='<li class="menuControls"> <a href="javascript:void(0);" onclick="shindig.container.getGadget('+this.id+').handleToggle(this);"><div id="toggleBtn_'+this.id+'" class="'+q+' openCloseBtn" title="'+p+'"style="background-image: url(\''+gadgetIconPath+"/gsframeworksprite.png');\"></div></a></li>";if(this.isCanvasViewAvailable){l+='<li class="menuControls"> <a href="javascript:void(0);" onclick="shindig.container.getGadget('+this.id+').openCanvasView();"><div class="sprite-canvas"  title="'+decodeURIComponent(sgf.labels.openCanvas)+'" style="background-image: url(\''+gadgetIconPath+"/gsframeworksprite.png');\"></div></a></li>"}l+='<li class="menuControls"><a href="javascript:void(0);" id="button-'+this.getUserPrefsDialogId()+'" onclick="shindig.container.getGadget('+this.id+').openMenuOptions();return false;" ><div class="sprite-options"  title="'+decodeURIComponent(sgf.labels.openOptions)+'" style="background-image: url(\''+gadgetIconPath+"/gsframeworksprite.png');\"></div></a></li>";l+='<ul class="submenu" id="sb-'+this.getUserPrefsDialogId()+'"></ul>';l+="</ul>";l+="</div>";l+='<div id="Close_'+this.id+'" class="Controls_close" style="display:none;"><a href="javascript:shindig.container.getGadget('+this.id+').closeGadget();"><div class="sprite-close_hoover"  title="'+decodeURIComponent(sgf.labels.close)+'" style="background-image: url(\''+gadgetIconPath+"/gsframeworksprite.png');\"></div></a></div>";l+="</div>"}log(this.sciverseId_,"got title bar content");h(l)};shindig.SciverseGadget.prototype.closeGadget=function(){jQuery("#maincont"+this.getIframeId()).parent().remove()};shindig.SciverseGadget.prototype.getUserPrefsDialogContent=function(a){a('<div id="'+this.getUserPrefsDialogId()+'"  style="display: none;z-index: 10; left: 0px;top:0px;border: 1px solid #CDF0A4;border-top:0px ;font: smaller;background-color:#EEF7E3; width:99%;font-weight:bold;" class=""></div>')};shindig.SciverseGadget.prototype.handleCancelUserPrefs=function(){var a=false;jQuery("#"+this.getUserPrefsDialogId()).slideToggle()};shindig.SciverseGadget.prototype.handleToggle=function(c){if(jQuery("#"+this.getUserPrefsDialogId()).css("display")=="block"){jQuery("#"+this.getUserPrefsDialogId()).slideToggle()}var d=false;var b="SubmitActionUsage";var i="";var h=false;if(jQuery(c).children()[0]!=null&&jQuery(c).children()[0].tagName=="DIV"){d=true}var j="";if(this.requiresPubSub2){j=this.oaaIframeId}else{j=this.getIframeId()}var m=document.getElementById(j);if(m){var l=jQuery("#maincont"+this.getIframeId()).css("display");var e=jQuery("#"+j);var g=jQuery("#toggleBtn_"+this.id);var f=jQuery("#footer"+this.cssClassTitleBar+"-"+this.id);if(l=="none"){if(e.attr("src")==""){e.attr("src",this.getIframeUrl())}g.removeClass("sprite-open").addClass("sprite-close").attr("title",decodeURIComponent(sgf.labels.closeApp));f.removeClass("InactiveGadget").addClass("ActiveGadget").removeClass("sgfClose").addClass("sgfOpen");jQuery("#GadgetName"+this.id).css("font-weight","bold")}else{g.removeClass("sprite-close").addClass("sprite-open").attr("title",decodeURIComponent(sgf.labels.openApp));f.removeClass("ActiveGadget").addClass("InactiveGadget").removeClass("sgfOpen").addClass("sgfClose");if(!jQuery("#"+this.location).hasClass("sgfIsGadgeGator")){jQuery("#GadgetName"+this.id).css("font-weight","normal")}}jQuery("#maincont"+this.getIframeId()).slideToggle("normal",function(){var n=parseInt(jQuery("#sciverse_toolbar").height(),10)-7;n+="px";resetHomePageColumnHeights();adjustHomePageColumnHeights()});var a=this.open;if(a==="N"){i="openGadget";this.open="Y"}else{i="closeGadget";this.open="N"}if(d){if(jQuery("#sb-"+this.getUserPrefsDialogId()).css("display")=="block"){jQuery("#sb-"+this.getUserPrefsDialogId()).toggle()}}else{this.openMenuOptions()}}this.saveGadgetState(i,b,h)};shindig.SciverseGadget.prototype.saveGadgetState=function(f,b,e){var i=sciverseObj.contextInfo.pageType;var d="";var c="";if(this.open==="N"){d="N";c="close|visible"}else{d="Y";c="open|visible"}var g=this.location;var h="gadgetDefinition="+this.specUrl+"&location="+this.location+"&gadgetOpen="+d;h+="&eventName="+f+"&keyEventType="+b+"&zone="+g;h+="&pageName="+i+"&isKeyEventURLAvailble="+isKeyEventURLExists;h+="&gadgetId="+this.sciverseId_+"&moduleName=gadget&gadgetState="+c;var a=new Array();a.push(sciverseObj.smapiVars.gsUrl);a.push("/rest/gadgetstate/gadget/gs/");a.push(this.sciverseId_);a.push("?clientToken=");a.push(sciverseObj.contextInfo.secureAuthtoken);a.push("&sessionId=");a.push(sciverseObj.contextInfo.sessionId);jQuery.ajax({type:"POST",url:a.join(""),data:h})};shindig.SciverseGadget.prototype.openMenuOptions=function(){var g=sciverseObj.smapiVars.gadgetDetailPage+"/"+this.sciverseId_;var f=false;var c;c="sb-";c+=this.getUserPrefsDialogId();var i=jQuery("#"+this.getIframeId()).parents(".containerApplOver").prev().attr("id");var e=jQuery("#"+this.getIframeId()).parents(".containerApplOver").next().attr("id");if(jQuery("#"+e).hasClass("ExtendedAreaApp")){e=null}var l=jQuery("#"+c).parent();var h=jQuery(l).position();var d=jQuery(l).find("li");var b=jQuery("#"+c);if(b.css("display")=="none"){b.css("display","block")}else{b.css("display","none")}var j="";if(this.open==="Y"){j+='<li><a href="javascript:void(0);"onclick="shindig.container.getGadget('+this.id+').handleToggle(this);">'+decodeURIComponent(sgf.labels.turnOff)+"</a></li>"}else{j+='<li><a href="javascript:void(0);"onclick="shindig.container.getGadget('+this.id+').handleToggle(this);">'+decodeURIComponent(sgf.labels.turnOn)+"</a></li>"}if(this.hasUserPrefs){j+='<li><a href="javascript:void(0);" onclick="shindig.container.getGadget('+this.id+').handleOpenUserPrefsDialog();">'+decodeURIComponent(sgf.labels.editPrefs)+"</a></li>"}if(navigator.userAgent.indexOf("Firefox")===-1){if(e!="undefined"&&e!=""&&e!=null){j+='<li><a href="#" onclick="shindig.container.getGadget('+this.id+').moveDOWN();return false;">'+decodeURIComponent(sgf.labels.moveDown)+"</a></li>"}else{j+='<li><div class="inactiveMenu">'+decodeURIComponent(sgf.labels.moveDown)+"</div></li>"}if(i!="undefined"&&i!=""&&i!=null){j+='<li><a href="#" onclick="shindig.container.getGadget('+this.id+').moveUP();return false;">'+decodeURIComponent(sgf.labels.moveUp)+"</a></li>"}else{j+='<li><div class="inactiveMenu">'+decodeURIComponent(sgf.labels.moveUp)+"</div></li>"}}b.html(j);b.css({top:Number(h.top+10)+"px",left:Number(h.left-b.outerWidth()-5)+"px"});var a=checkCompliance();if(a=="Quirks"&&truncateURL){var m=jQuery(d[0]).position();b.css("left",Number(m.left-b.outerWidth()-5)+"px")}jQuery(subMenuIdBuf).unbind("clickoutside");submenuID="#sb-"+this.getUserPrefsDialogId();if(submenuID1!==submenuID){jQuery(submenuID1).hide()}submenuID1="#sb-"+this.getUserPrefsDialogId();subMenuIdBuf="#button-"+this.getUserPrefsDialogId();jQuery("#button-"+this.getUserPrefsDialogId()).bind("clickoutside",function(n){jQuery(submenuID1).hide()})};shindig.SciverseGadget.prototype.moveUP=function(){var e="#sb-"+this.getUserPrefsDialogId();var c=jQuery("#"+this.getIframeId()).parents(".containerApplOver");var b=c.prev();var d=b.attr("id");if(!b.hasClass("tempExtendedAreaApp")&&c.hasClass("tempExtendedAreaApp")){c.removeClass("tempExtendedAreaApp");b.addClass("tempExtendedAreaApp")}jQuery("#"+this.getIframeId()).parents(".containerApplOver").insertBefore("#"+d);var a=(jQuery("#"+this.location).hasClass("sgfHomePage"))?getGadgetOrderHomePage(this.location):getGadgetOrder(this.location);saveToolBarState(g_toolbarState,"gadgetReorder","SubmitActionUsage",false,this.location,a,showMoreApps);jQuery(e).hide()};shindig.SciverseGadget.prototype.moveDOWN=function(){var e="#sb-"+this.getUserPrefsDialogId();var c=jQuery("#"+this.getIframeId()).parents(".containerApplOver");var d=c.next();var b=d.attr("id");if(d.hasClass("tempExtendedAreaApp")){d.removeClass("tempExtendedAreaApp");c.addClass("tempExtendedAreaApp")}jQuery("#"+this.getIframeId()).parents(".containerApplOver").insertAfter("#"+b);var a=(jQuery("#"+this.location).hasClass("sgfHomePage"))?getGadgetOrderHomePage(this.location):getGadgetOrder(this.location);saveToolBarState(g_toolbarState,"gadgetReorder","SubmitActionUsage",false,this.location,a,showMoreApps);jQuery(e).hide()};shindig.SciverseGadget.prototype.togglesubmenu=function(){jQuery("#sb-"+this.getUserPrefsDialogId()).toggle()};shindig.SciverseGadget.prototype.getUserPrefs=function(){return this.userPrefs};shindig.SciverseGadget.prototype.resizeUserPrefsDialog=function(){var a=this.getUserPrefsDialogId();jQuery("#"+a).css({width:"100%",height:"100%"})};shindig.SciverseGadget.prototype.getUserPrefsParams=function(){var b="";for(var a in this.getUserPrefs()){b+="&up_"+encodeURIComponent(a)+"="+encodeURIComponent(this.getUserPrefValue(a))}return b};shindig.SciverseGadget.prototype.handleOpenUserPrefsDialog=function(){var c=this;terms=new Array();var b="ig_callback_"+this.id;window[b]=function(f){c.userPrefsDialogContentLoaded=true;var e=f;c.buildUserPrefsDialog(e);c.showUserPrefsDialog();var d=jQuery("#ig_edit_div"+c.id+" input");for(var g=0;g<d.length;g++){var h=d[g];if(h.type==="text"||h.type==="hidden"){h.value=decodeURIComponent(decodeURIComponent(jQuery("<div/>").html(h.value).text()))}}};var a=document.createElement("script");a.src=sciverseObj.smapiVars.gsUrl+"/gadgetsettings?mid="+this.id+"&output=js"+this.getUserPrefsParams()+"&url="+this.specUrl;document.body.appendChild(a);resetHomePageColumnHeights();adjustHomePageColumnHeights();if(this.open==="N"){shindig.container.getGadget(this.id).handleToggle(this)}else{jQuery("#sb-"+this.getUserPrefsDialogId()).toggle()}};function removeItemsFromList(a){jQuery("#"+a).remove()}function addItemsToList(d){var c=document.getElementById(d).value;terms.push(c);var b=document.createElement("li");b.innerHTML='<li style="margin-left:20px;">'+c+"</li>";var a=document.getElementById("listItemsUL");a.appendChild(b)}shindig.SciverseGadget.prototype.handleSaveUserPrefs=function(){jQuery("#"+this.getUserPrefsDialogId()).slideToggle();var d=document.getElementById("m_"+this.id+"_numfields").value;for(var e=0;e<d;e++){var h=document.getElementById("m_"+this.id+"_"+e);var m="m_"+this.id+"_up_";var f=h.name.substring(m.length);var j=escape(encodeURIComponent(h.value));if(typeof(this.userPrefs[f])=="undefined"&&f.indexOf("list")<0){var a=new Object();a.name=f;a.value=j;this.userPrefs[f]=a}else{if(f.indexOf("list")>0){var g=f.substring(0,f.indexOf("_list"));if(typeof(this.userPrefs[g])!="undefined"){var b=new Array();b.push(this.userPrefs[g].value);for(var c=0;c<terms.length;c++){b.push(terms[c])}this.userPrefs[g].value=b}else{var l=new Array();for(var c=0;c<terms.length;c++){l.push(terms[c])}this.userPrefs[g].value=l}}else{if(h.type=="checkbox"){this.userPrefs[f].value=h.checked}else{if(h.type=="text"||h.type=="hidden"||h.type=="select-one"){this.userPrefs[f].value=j}}}}}this.saveUserPrefs();this.refresh()};function convertToHtmlEntities(a){a=a.replace(/&/g,"&amp;");a=a.replace(/>/g,"&gt;");a=a.replace(/</g,"&lt;");a=a.replace(/"/g,"&quot;");a=a.replace(/'/g,"&#039;");return a}function convertFromHtmlEntities(a){a=a.replace(/&amp;/g,"&");a=a.replace(/%26amp%3B/g,"&");a=a.replace(/&gt;/g,">");a=a.replace(/%26gt%3B/g,">");a=a.replace(/&lt;/g,"<");a=a.replace(/%26lt%3B/g,"<");a=a.replace(/&quot;/g,'\\"');a=a.replace(/%26quot%3B/g,"%22");a=a.replace(/&#039;/g,"'");a=a.replace(/%26%23039%3B/g,"'");return a}shindig.DefaultUserPrefStore.prototype.getPrefs=function(a){};shindig.DefaultUserPrefStore.prototype.savePrefs=function(g){var f=gadgets.json.stringify(g.userPrefs);var b="saveGadgetPreferences";var a=g.location;var d=false;var e="userPreferences="+f+"&";e+="location="+g.location+"&";e+="originPage="+sciverseObj.contextInfo.pageType+"&";e+="keyEventType=SubmitActionUsage&";e+="gadgetDefinition="+g.specUrl+"&";e+="eventName="+b+"&";e+="gadgetId="+g.sciverseId_+"&";e+="gadgetName="+g.title+"&";e+="zone="+a+"&";e+="pageName="+sciverseObj.contextInfo.pageType+"&";e+="isKeyEventURLAvailble="+isKeyEventURLExists+"&";e+="hidden=N";var c=new Array();c.push(sciverseObj.smapiVars.gsUrl);c.push("/rest/userpreference/gs/");c.push(g.sciverseId_);c.push("?clientToken=");c.push(sciverseObj.contextInfo.secureAuthtoken);c.push("&sessionId=");c.push(sciverseObj.contextInfo.sessionId);jQuery.ajax({type:"POST",url:c.join(""),data:e})};shindig.SciverseGadget.prototype.openCanvasView=function(c){var d=document.createElement("div");d.id="canvas";var b;sgf.currentCanvasHolder=this.sciverseId_;jQuery("body").prepend('<div id=canvas></div><div class="clear"></div>');shindig.container.layoutManager=new shindig.FloatLeftLayoutManager(d.id);var a=shindig.container.createGadget({specUrl:this.specUrl,title:this.title,userPrefs:this.userPrefs,requiresPubSub2:this.requiresPubSub2});a.sciverseId_=this.sciverseId_;a.open=this.open;a.location=this.location;a.iconURL=(this.iconURL==null||this.iconURL=="")?gadgetIconPath+"/netbase.gif":this.iconURL;shindig.container.addGadget(a);a.prepareGadgetForView("canvas",d,c);var e=this.location;if(e!=null&&e.indexOf("resultsView")!=-1){b="resultsView"}else{b=this.location}};shindig.SciverseGadget.prototype.prepareGadgetForView=function(c,a,b){var d=this.getIframeUrl();d=buildViewUrl(d,c,b);shindig.container.renderGadget(this,c,d,a)};shindig.SciverseGadget.prototype.closeCanvas=function(e){var g=false;var h="SubmitActionUsage";var b="closeCanvas";var d=false;jQuery("body").css("overflow","auto");if(jQuery(e).children()[0]!=null&&jQuery(e).children()[0].tagName=="IMG"){g=true}var c=jQuery("#canvas");c.children().remove();c.remove();if(MSIE7Flag===true){}else{window.history.back()}jQuery("#"+sciverseObj.contextInfo.pageContentDivTagName).show();var a;var f=this.location;if(f!=null&&f.indexOf("resultsView")!=-1){a="resultsView"}else{a=this.location}if(jQuery("#sb-"+this.getUserPrefsDialogId()).css("display")=="block"){jQuery("#sb-"+this.getUserPrefsDialogId()).toggle()}focusGadget()};function buildViewUrl(b,a,d){var e=getUrlParam("view",b);if(e){var b=b.replace("view="+e,"view="+a)}else{b+="&view="+encodeURIComponent(a)}if(d){var c=gadgets.json.stringify(d);if(c.length>0){b+="&view-params="+encodeURIComponent(c)}}return b}function getUrlParam(c,b){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+c+"=([^&#]*)";var e=new RegExp(a);var d=e.exec(b);if(d==null){return""}else{return d[1]}}var canvasUrl="";shindig.SciverseGadget.prototype.getCanvasContent=function(b,a){canvasUrl=b;shindig.callAsyncAndJoin([this.getCanvasTitleBarContent,this.getCanvasMainContent],function(c){a(c.join(""))},this)};shindig.SciverseGadget.prototype.getCanvasTitleBarContent=function(a){if(this.includeChrome==false){a("");return}var c;if(this.title){c=this.title}else{c="title"}var b='<div id="footer'+this.cssClassTitleBar+"-"+this.id+'" class="curveBoxRight ActiveGadget" >';b+='<img src="'+this.iconURL+'"  border="none" class="headingGadgetIcon" title="'+this.title+'">';b+='<h3 id="GadgetName'+this.id+'" class="elsevierTimeLOver">'+c+'</h3><div class="CanvasControls"><ul>';b+='<li> <a href="javascript:void(0);" onclick="shindig.container.getGadget('+this.id+').closeCanvas(this);"><img id="img_'+this.id+'" style="border: 0px;" src="'+gadgetIconPath+'/close_hoover.gif" title="'+decodeURIComponent(sgf.labels.closeApp)+'"/></a></li>';b+="</ul>";b+="</div>";b+='<div class="clear"></div>';b+="</div>";a(b)};shindig.IfrGadget.getCanvasMainContent=function(b){var d=this.getIframeId();var a=sciverseObj.smapiVars.gadgetDetailPage+"?appId="+this.sciverseId_;var c='<div id="maincont'+d+'" class="containerAppDetailsCanvas" style="height:100%"';c+=(this.height?' style="height: '+this.height+'px;"':"")+'><iframe id="'+d+"\" onload=\"sgf.killTimer('canvas', 'canvas')\" name=\""+d+'" class="gadgets-gadgetCanvas '+this.cssClassGadget+'" src="'+canvasUrl+'" frameborder="no" scrolling="auto" width="100%"></iframe>';c+="</div>";b(c);gadgets.rpc.setRelayUrl(d,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(d,this.rpcToken)};shindig.SciverseGadget.prototype.renderCanvas=function(a,b){this.getCanvasContent(a,function(c){jQuery("#canvas").html(c);loadCanvas(b)});if(this.requiresPubSub2===true){this.finishRender(a)}};shindig.SciverseGadget.prototype.renderResultsView=function(a,b){this.getResultsViewContent(b,a,function(c){a.innerHTML=c});if(this.requiresPubSub2===true){this.finishRender(b)}};shindig.SciverseGadget.prototype.getResultsViewContent=function(c,b,a){this.resultsViewUrl=c;this.resultsViewChrome=b;var d=this.getIframeId();gadgets.rpc.setRelayUrl(d,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(d,this.rpcToken);shindig.callAsyncAndJoin([this.getResultsViewTitleBarContent,this.getResultsViewMainContent],function(e){a(e.join(""))},this)};shindig.SciverseGadget.prototype.getResultsViewTitleBarContent=function(a){var c;if(this.title){c=this.title}else{c="title"}var b="";a(b)};shindig.IfrGadget.getResultsViewMainContent=function(a){var c=this.getIframeId();var b="";b+='<div id="mainCon'+c+'" class="containerAppDetailsRes"  > ';b+='<iframe id="'+this.getIframeId()+'" onload="sgf.killTimer(\''+this.sciverseId_+"', '"+this.location+'\');" name="'+this.getIframeId()+'"  src="'+this.resultsViewUrl+'" frameborder="no" scrolling="auto" width="100%" style="height: 1px;" ></iframe></div>';b+="</div>";a(b)};shindig.SciverseGadget.prototype.closeResultView=function(){jQuery("#footer_res_gadgets-gadget-title-bar-"+this.id).parent().remove()};shindig.SciverseGadget.prototype.renderHooverView=function(a,b){this.getHooverViewContent(b,a,function(c){a.innerHTML=c})};shindig.SciverseGadget.prototype.getHooverViewContent=function(c,b,a){this.resultsViewUrl=c;this.resultsViewChrome=b;var d=this.getIframeId();gadgets.rpc.setRelayUrl(d,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(d,this.rpcToken);shindig.callAsyncAndJoin([this.getHooverViewTitleBarContent,this.getHooverViewMainContent],function(e){a(e.join(""))},this)};shindig.SciverseGadget.prototype.getHooverViewTitleBarContent=function(a){var b='<div id="hoover-'+this.id+'" class="ActiveGadget curveBoxleftNormal hooverTitle hoverViewTitleForSD" style="cursor: move;">';b+='<img src="'+this.iconURL+'"  border="none" class="headingGadgetIcon" title="'+this.title+'">';b+='<h3 id="GadgetName'+this.id+'" class="elsevierTimeLOver">'+this.title+'</h3><div  class="HoverControls Controls" align="right"><ul  class="menu">';b+='<li> <a href="javascript:shindig.container.getGadget('+this.id+').togglePin();"><img id="pin_'+this.id+'" src="'+gadgetIconPath+'/pin-up-off.gif" title="'+decodeURIComponent(sgf.labels.pin)+'" /></a></li>';b+="<li> <a href=javascript:shindig.container.getGadget("+this.id+').closeHooverView();><img  src="'+gadgetIconPath+'/close_hoover.gif" title="'+decodeURIComponent(sgf.labels.close)+'" /></a></li>';b+="</ul>";b+="</div>";b+="</div>";a(b)};shindig.SciverseGadget.prototype.getHooverViewMainContent=function(a){a('<div id="hoover_frameDiv_'+this.id+'" class="containerAppDetails" ><iframe id="'+this.getIframeId()+'" onload="sgf.killTimer(\''+this.sciverseId_+"', '"+this.location+'\');" name="'+this.getIframeId()+'" class="'+this.cssClassGadget+'" src="'+this.resultsViewUrl+'" frameborder="no" scrolling="auto" width="100%" height="'+this.height+'"></iframe></div>')};shindig.SciverseGadget.prototype.closeHooverView=function(){jQuery("#hoover-"+this.id).parent().remove()};shindig.SciverseGadget.prototype.togglePin=function(){var c=jQuery("#"+this.getIframeId()).parent().parent().attr("id");var e=document.getElementById(c);var b;var d;var f=jQuery("#"+c);var a=jQuery("#pin_"+this.id);if(f.css("position")=="absolute"){f.css("position","fixed");b=parseInt(e.style.top,10)-jQuery(window).scrollTop();b+="px";a.attr("src",gadgetIconPath+"/pin-dn-off.gif");a.attr("title",decodeURIComponent(sgf.labels.unpin));this.pinPosition="fixed";d=checkCompliance();if(d=="Quirks"){if(f.attr("lang")==""){f.css("position","absolute");f.attr("lang",b);jQuery(window).scroll(function(){var g=f.attr("lang");var i=g.substring(0,g.length-2);var h=jQuery(document).scrollTop()+Number(i);jQuery("#"+c).css("top",h+"px")})}else{a.attr("src",gadgetIconPath+"/pin-up-off.gif");a.attr("title",decodeURIComponent(sgf.labels.pin));jQuery(window).unbind("scroll");f.css("position","absolute");f.attr("lang","");this.pinPosition="absolute"}}else{f.css("top",b)}}else{d=checkCompliance();f.css("position","absolute");b=parseInt(e.style.top,10)+jQuery(window).scrollTop();b+="px";f.css("top",b);this.pinPosition="absolute";a.attr("src",gadgetIconPath+"/pin-up-off.gif");a.attr("title",decodeURIComponent(sgf.labels.pin))}};function log(b,a,c){if(debug){jQuery("#"+a+"_debug_"+b).append("\n<br>"+c+"->"+calculateUTCTime())}}function calculateUTCTime(){var j;var h=new Date();var l=h.getUTCDate();var i=h.getUTCMonth();var e=h.getUTCFullYear();var a=h.getUTCHours();var f=h.getUTCMinutes();var g=h.getUTCSeconds();var c=h.getUTCMilliseconds();j=l+"-"+i+"-"+e+" ";var b="AM";if(a==0){a=12}if(a>12){a=a-12;b="PM"}f=f+"";if(f.length==1){f="0"+f}g=g+"";if(g.length==1){g="0"+g}j+=a+":"+f+":"+g+":"+c+" "+b;return j}shindig.IfrGadget.getIframeUrl=function(){var f=shindig.container.country_;var e=shindig.container.language_;if(sciverseObj.contextInfo.locale){e=sciverseObj.contextInfo.locale.substring(0,2);f=sciverseObj.contextInfo.locale.substring(3)}var b=this.serverBase_+"ifr?container="+this.CONTAINER+"&mid="+this.id+"&nocache="+shindig.container.nocache_+"&country="+f+"&lang="+e+"&view="+shindig.container.view_+(this.specVersion?"&v="+this.specVersion:"")+(shindig.container.parentUrl_?"&parent="+encodeURIComponent(shindig.container.parentUrl_):"")+(this.debug?"&debug=1":"")+this.getAdditionalParams();if(truncateURL){var c=false;for(var a in this.getUserPrefs()){var d="";d+="&up_"+encodeURIComponent(a)+"="+encodeURIComponent(this.getUserPrefValue(a));if((b+d).length<2074){b+=d}else{c=true}}if(c){b+="&urlMgld=y"}}else{b+=this.getUserPrefsParams()}b+=(this.secureToken?"&st="+this.secureToken:"")+"&url="+encodeURIComponent(this.specUrl)+"#rpctoken="+this.rpcToken+(this.viewParams?"&view-params="+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(this.hashData?"&"+this.hashData:"");return b};shindig.SciverseGadget.prototype.renderColumnView=function(a,b){this.getColumnViewContent(b,a,function(c){a.innerHTML=c});if(this.requiresPubSub2===true){this.finishRender(b)}};shindig.SciverseGadget.prototype.getColumnViewContent=function(c,b,a){this.columnViewUrl=c;this.columnViewChrome=b;var d=this.getIframeId();gadgets.rpc.setRelayUrl(d,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(d,this.rpcToken);shindig.callAsyncAndJoin([this.getColumnViewTitleBarContent,this.getColumnViewMainContent],function(e){a(e.join(""))},this)};shindig.SciverseGadget.prototype.getColumnViewTitleBarContent=function(a){var b;if(this.title){title=this.title}else{b="title"}a("")};shindig.IfrGadget.getColumnViewMainContent=function(a){var c=this.getIframeId();var b=[];b.push('<div id="mainCon',c,'"',' class="containerAppDetailsRes">');b.push('<iframe id="',c,'"');b.push(" onload=\"sgf.killTimer('",this.sciverseId_,"','",this.location,"');\"");b.push(' name="',c,'" src="',this.columnViewUrl,'"');b.push(' frameborder="no" scrolling="auto" width="100%" style="height: 100%;"></iframe></div>');a(b.join(""))};shindig.OAAIfrGadget={getMainContent:function(a){a('<div id="maincont'+this.getIframeId()+'" class="containerAppDetails"></div>');sgf.killTimer(this.sciverseId_,this.location)},getCanvasMainContent:function(a){a('<div id="maincont'+this.getIframeId()+'" class="containerAppDetails"></div>');sgf.killTimer("canvas","canvas")},getResultsViewMainContent:function(a){a('<div id="maincont'+this.getIframeId()+'" class="containerAppDetailsRes"></div>');sgf.killTimer(this.sciverseId_,this.location)},getHooverViewMainContent:function(a){a('<div id="maincont'+this.getIframeId()+'" class="box appText"></div>');sgf.killTimer(this.sciverseId_,this.location)},finishRender:function(a){var b={className:this.cssClassGadget,frameborder:"no",scrolling:"auto"};if(this.height){b.height=this.height}else{b.height=150}if(this.width){b.width=this.width}iframeContainer=new OpenAjax.hub.IframeContainer(gadgets.pubsub2router.hub,this.getIframeId(),{Container:{onSecurityAlert:function(e,d){gadgets.error("Security error for container "+e.getClientID()+" : "+d)},onConnect:function(d){}},IframeContainer:{parent:document.getElementById("maincont"+this.getIframeId()),uri:a?a:this.getIframeUrl(),tunnelURI:shindig.uri(this.serverBase_+this.rpcRelay).resolve(shindig.uri(window.location.href)),iframeAttrs:b}});var c=iframeContainer.getIframe().id;return c},getIframeUrl:function(){furl=this.serverBase_+"ifr?container="+this.CONTAINER+"&mid="+this.id+"&nocache="+shindig.container.nocache_+"&country="+shindig.container.country_+"&lang="+shindig.container.language_+"&view="+shindig.container.view_+(this.specVersion?"&v="+this.specVersion:"")+(shindig.container.parentUrl_?"&parent="+encodeURIComponent(shindig.container.parentUrl_):"")+(this.debug?"&debug=1":"")+this.getAdditionalParams()+this.getUserPrefsParams()+(this.secureToken?"&st="+this.secureToken:"")+"&url="+encodeURIComponent(this.specUrl)+"#rpctoken="+this.rpcToken+(this.viewParams?"&view-params="+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(this.hashData?"#"+this.hashData:"");return furl}};shindig.SciverseGadget.prototype.getIframeUrlWithPreferredView=function(){var a=this.getIframeUrl();if(this.preferredView!=null){a=buildViewUrl(a,this.preferredView)}return a};function checkCompliance(){var a=document.compatMode;var b="";if(a){if(a=="BackCompat"){b="Quirks"}else{if(a=="CSS1Compat"){b="Standards Compliance"}}return b}}sgf.resultsChanged=function(){addAllButtonResults={};buttonCounter=-1;var c="results";if(listeners[c]!=null){var d=listeners[c]}if(d==null){return}for(var a=0;a<d.length;a++){var b=d[a];gadgets.rpc.call(b.frame,b.callback,null,null)}};sgf.notifyGadgetsOfSummaryViewChange=function(d){var c="hubSummaryView";if(listeners[c]!=null){var e=listeners[c]}if(e==null){return}for(var a=0;a<e.length;a++){var b=e[a];gadgets.rpc.call(b.frame,b.callback,null,d)}};sgf.clearSelection=function(a){if(!a){var a=window.event}if((browser!=="IE"&&a.button==0)||(browser==="IE"&&a.button==1)){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}}return};sgf.getSelectedText=function(h){if(!h){var h=window.event}var j="";if(window.getSelection){range=window.getSelection();j=range.toString()}else{if(document.selection.createRange){range=document.selection.createRange();j=range.text}}if(j.length==0){return}var g=h.pageX?h.pageX:(h.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft));var d=h.pageY?h.pageY:(h.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop));var f=listeners.highlightedText;if(f==null){return}for(var b=0,a=f.length;b<a;b++){var c=f[b];gadgets.rpc.call(c.frame,c.callback,null,j,g,d)}};if(!document.all){document.captureEvents(Event.DBCLICK|Event.MOUSEUP)}document.onmouseup=sgf.getSelectedText;sgf.getWindowScrollEvent=function(f){if(!f){var f=window.event}var d=listeners.windowscroll;if(d==null){return}for(var b=0,a=d.length;b<a;b++){var c=d[b];gadgets.rpc.call(c.frame,c.callback,null,null)}};jQuery(document).ready(function(a){a(document).scroll(function(){sgf.getWindowScrollEvent(a)})});sgf.getSubjectAreas=function(a,b){jQuery.ajax({type:"GET",url:sciverseObj.smapiVars.gsUrl+"/rest/subjectarea",async:true,success:function(c){gadgets.rpc.call(a,b,null,c)},error:function(){gadgets.rpc.call(a,b,null,null)}})};sgf.getContent=function(a,b){jQuery.ajax({type:"GET",url:sciverseObj.smapiVars.gsUrl+"/rest/sourcetype?application=contenttab",async:true,success:function(c){gadgets.rpc.call(a,b,null,c)},error:function(){gadgets.rpc.call(a,b,null,null)}})};sgf.getSubType=function(a,b){jQuery.ajax({type:"GET",url:sciverseObj.smapiVars.gsUrl+"/rest/subtype",async:true,success:function(c){gadgets.rpc.call(a,b,null,c)},error:function(){gadgets.rpc.call(a,b,null,null)}})};function loadCanvas(b){if(MSIE7Flag===true){}else{jQuery.bbq.pushState({dialogId:"canvas"})}jQuery("#canvas").dialog({autoOpen:true,modal:true,resizable:false,draggable:false});var a=jQuery("#canvas").parent(".ui-dialog");a.siblings(".ui-widget-overlay").css("opacity","0.25");a.hide();alignCanvas()}function alignCanvas(){var c=jQuery(window).width();var f=jQuery(window).height();var e=jQuery(window).scrollTop()+50;var b=jQuery("#canvas");var g=b.parent(".ui-dialog");var d=g.siblings(".ui-widget-overlay");var a=b.find(".containerAppDetailsCanvas");if(browser==="IE"){g.css({width:c-70,left:"20px","margin-right":"20px",height:f-100,"margin-top":e,"margin-bottom":"50px","z-index":"9999"});a.css("height",f-130);b.css({width:c-70,height:f-95,"margin-left":"2px","margin-top":"1px"})}else{g.css({width:c-60,"margin-left":"20px","margin-right":"20px",height:f-100,"margin-top":e,"margin-bottom":"50px","z-index":"9999"});a.css({height:f-131,"margin-bottom":0});b.css({width:c-60,height:f-100,"margin-left":"3px","margin-top":"1px"})}if(isSDResultsPage()){g.css("top","-50px");b.css({margin:"0px",position:"static"})}if(isSDResultsPage()||isSDArticlesPage()){a.css("width","99.8%")}g.find(".ui-dialog-titlebar").remove();b.dialog("option","position","top");b.css("padding","0px");if(MSIE7Flag===true){g.css("overflow","hidden");b.css("overflow","hidden");b.css("width",c-70);jQuery(".CanvasControls ul").css("padding-left","40px");jQuery(".CanvasControls").css("margin-top","0px")}g.css({position:"absolute",top:"0px"});d.css({height:jQuery("body").outerHeight()});b.css("top","0px");if(isSDArticlesPage()){d.css({height:jQuery(window).outerHeight()})}jQuery("#canvas h3.elsevierTimeLOver").css("cursor","auto");g.show();verticalScroll=jQuery(window).scrollTop();jQuery("body").css("overflow","hidden")}function focusGadget(){window.scroll(0,verticalScroll)}jQuery(window).resize(function(){if(jQuery("#canvas").length){alignCanvas()}});sgf.notifyNavigatorSelection=function(d){var c="selection";if(listeners[c]!=null){var e=listeners[c]}if(e==null){return}for(var a=0;a<e.length;a++){var b=e[a];gadgets.rpc.call(b.frame,b.callback,null,d)}};shindig.SciverseGadget.prototype.renderMmcView=function(a,b){this.getMmcViewContent(b,a,function(c){a.innerHTML=c})};shindig.SciverseGadget.prototype.getMmcViewContent=function(c,b,a){this.resultsViewUrl=c;this.resultsViewChrome=b;var d=this.getIframeId();gadgets.rpc.setRelayUrl(d,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(d,this.rpcToken);shindig.callAsyncAndJoin([this.getMmcViewTitleBarContent,this.getMmcMainContent],function(e){a(e.join(""))},this)};shindig.SciverseGadget.prototype.getMmcViewTitleBarContent=function(a){var c;if(this.title){c=this.title}else{c="title"}var b="";a(b)};shindig.IfrGadget.getMmcMainContent=function(a){var c=this.getIframeId();var b="";b+='<div id="mainCon'+c+'"  > ';b+='<iframe id="'+this.getIframeId()+'" onload="sgf.killTimer(\''+this.sciverseId_+"', '"+this.location+'\');" name="'+this.getIframeId()+'"  src="'+this.resultsViewUrl+'" frameborder="no" scrolling="auto" style="overflow-y:hidden;"  width="100%" ></iframe></div>';a(b)};sgf.continueFrameworkActivities=function(a){this.processMmcGadgets(a);this.processInterRefs(a);this.continueLinkText(a)};sgf.continueLinkText=function(b){if(typeof this.linkTextFrames==="undefined"||null===this.linkTextFrames){return}var a=this.linkTextFrames.length;if(a===0){return}var g=jQuery("#"+b);for(var e=0;e<a;e++){var h=this.linkTextFrames[e];var c=h.categories;if(jQuery.inArray("all",c)>-1){this.doLinkText(g,h.frame,h.terms,h.categories,h.frequency,h.occurence,h.callbackName);continue}for(var d=0;d<c.length;d++){if(jQuery("#"+b).parents(sgf.allCategories[c[d]]).length>0||jQuery("#"+b).find(sgf.allCategories[c[d]]).length>0){this.doLinkText(g,h.frame,h.terms,h.categories,h.frequency,h.occurence,h.callbackName);return}}}};shindig.ScienceDirectService=function(){shindig.IfrGadgetService.call(this)};shindig.ScienceDirectService.inherits(shindig.IfrGadgetService);shindig.ScienceDirectService.prototype.executeSDSearch=function(b){if(typeof(b)=="undefined"||b==null||b==""){return}var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var d=shindig.container.getGadget(e);var a=d.sciverseId_;var c=sciverseObj.smapiVars.searchQueryURL;c+="&gadgetST="+b;c+="&gadgetID="+a;window.location=c};shindig.IfrContainer.prototype.ScienceDirectService=new shindig.ScienceDirectService();